{% extends "page_schedule_maintenance.html" %}
{% load i18n %}
{% load static %}
{% load widget_tweaks %}
{% block title %}{{ page_title}} - Schedule Maintenance{% endblock %}
{% load static %}

{% block content %}
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
	
	<div class="content-header">
		<div class="col-6 offset-3">
		<form id="schedule_maintenance_form" method="POST" class="form-inline">
		{% csrf_token %}

		  <div class="form-row">
		    <div class="form-group">
		      <label for="inputPassword6">Schedule No</label>&nbsp;&nbsp;
		      <!--{% render_field form.cus_id %}&nbsp;-->
		      <input type="number"  maxlength="4" name="cus_id" class="form-control form-control-md col-2" placeholder="" required="" id="id_cus_id" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">&nbsp;
		      
		      <!--{% render_field form.cus_brn %}&nbsp;-->
		      <input type="number"  maxlength="3" name="cus_brn" class="form-control form-control-md col-2" placeholder="" required="" id="id_cus_brn" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">&nbsp;

		      <!--{% render_field form.cus_vol %}&nbsp;&nbsp;-->
		      <input type="number"  maxlength="3" name="cus_vol" class="form-control form-control-md col-2" placeholder="" required="" id="id_cus_vol" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">&nbsp;&nbsp;

		      <button id="cancelCustomerServicePersonButton" type="button" class="btn btn-md btn-warning pull-right">Cancel</button>
		    </div>
		  </div>
		</form>
		</div>
	</div>

    <!-- Main content -->
    <section class="content">
		


      	<!-- 1st Block -->
      	<!--<div class="card card-outline card-secondary">-->
      	<div class="card card-outline card-secondary collapsed-card">

	    	<div class="card-header">

		        <h1 class="card-title">
		          <span id="customer_name_title">
		            <h4 class="m-0"><b>Customer Information</b></h4>
		          </span>
		        </h1>

			    <div class="card-tools">			 		
			      	<button type="button" class="btn btn-tool" data-card-widget="collapse">ดูเพิ่มเติม<!--<i class="fas fa-minus"></i>--></button>
			    </div>

				<form id="contract_service_list_form" method="POST">
	      		{% csrf_token %}

		        	<div class="card-tools float-right">
		        	<!--
			          <button class="btn btn-outline-info btn-md dropdown-toggle" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			            <i class="fas fa-print fa-sm"></i>&nbsp;&nbsp;Print
			          </button>
			          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">			            
			            <a class="dropdown-item" href="#" onclick="print_contract()"><i class="fa fa-eye text-secondary" aria-hidden="true"></i>&nbsp;&nbsp;Display on screen</a>	
			            <input type="hidden" id="id_cnt_id_temp" name="cnt_id_temp" value="">
			          </div>
			      	
		          		<button id="cancelCustomerServicePersonButton" type="button" class="btn btn-md btn-default pull-right">Cancel</button>
		          	-->
		          		<!--
		          		<button id="saveCustomerServicePersonButton" class="btn btn-md btn-primary"><i class="fas fa-save fa-sm"></i>&nbsp;&nbsp;{% trans 'Save' %}</button>
		          		-->
		        	</div>

		    </div>
	       


	        <div class="card-body col-12">

				<!-- Contract Active Status -->
				<div class="row float-right">
                    <div class="btn-group">
                      <label class="switch">                                 
                        <input type="checkbox" id="id_cnt_active" name="cnt_active" disabled>
                        <div class="slider"></div>
                      </label>  
                    </div>

		            <div>&nbsp;</div>
				</div>

				<div class="clearfix">&nbsp;</div>

				<div class="row" style="white-space:nowrap;">

					<div class="col-8 float-left">

					  <div class="form-group row">
					    <label for="id_cus_main_cus_name" class="col-2 col-form-label" style="font-size:11pt">Customer</label>
					    <div class="col-6">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cus_main_cus_name_th">
					    </div>
						<label for="id_cus_main_cus_name" class="col-1 col-form-label" style="font-size:11pt">Phone</label>
					    <div class="col-3">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cus_main_cus_tel" >
					    </div>
					  </div>

					  <!-- Site Name -->
					  <div class="form-group row">
					    <label for="id_site_cus_name" class="col-sm-2 col-form-label" style="font-size:11pt">Site Name</label>
					    <div class="col-sm-6">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cus_site_name_th">
					    </div>				   
						<label for="id_site_cus_name" class="col-sm-1 col-form-label" style="font-size:11pt">Phone</label>
					    <div class="col-sm-3">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cus_site_tel" >
					    </div>

					  </div>

					  <!-- Site Address -->
					  <div class="form-group row">
					    <label for="id_cus_site_add" class="col-sm-2 col-form-label" style="font-size:11pt">Address</label>
					    <div class="col-sm-10">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cus_site_add_th">
					    </div>
					  </div>

					  <!-- Cnt.Ref. Address -->
					  <div class="form-group row">
					    
					    <label for="id_cnt_doc_no" class="col-sm-2 col-form-label" style="font-size:11pt">Contract Ref.</label>
					    <div class="col-sm-2">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cnt_doc_no">
					    </div>

					    <label for="id_cnt_doc_no" class="col-sm-2 col-form-label" style="font-size:11pt">Contact Person</label>
					    <div class="col-sm-6">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cus_site_contact_name_th">
					    </div>
					  </div>

					</div>


					<div class="col-4 float-right">

					  <div class="form-group row">
					    <label for="id_cnt_wage_name_en" class="col-4 col-form-label" style="font-size:11pt">Wage Rate</label>
					    <div class="col-sm-8">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cnt_wage_name_en" >
					    </div>
					  </div>

					  <div class="form-group row">
					  	<label for="id_cnt_apr_by_name_en" class="col-4 col-form-label" style="font-size:11pt">Authorized by</label>
					    <div class="col-sm-8">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:10pt" id="id_cnt_apr_by_name_en" >
					    </div>		    
					  </div>

					  <div class="form-group row">
					  	<label for="id_cus_main_cus_name" class="col-4 col-form-label" style="font-size:11pt">Contract Term</label>

					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control form-control-sm bg-light" style="font-size:10pt;" id="id_cnt_sign_frm" >
					    </div>
					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control form-control-sm bg-light" style="font-size:10pt;" id="id_cnt_sign_to" >
					    </div>
					  </div>

					  <div class="form-group row">
					  	<label for="id_cus_main_cus_name" class="col-4 col-form-label" style="font-size:11pt">Effective Term</label>
					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:10pt;border:3px solid #2ab934;" id="id_cnt_eff_frm" >
					    </div>
					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:10pt;border:3px solid #2ab934;" id="id_cnt_eff_to" >
					    </div>
					  </div>
					</div>
				</div>


			</div>


		   	</form>
      	</div>


      	<!-- Contract Service List -->      	
	    <div class="card card-contract-service-list card-outline card-secondary collapsed-card">
	      	<div class="card-header">                
	        	<div class="float-left"><h4 class="m-0 text-dark"><b>Contract Service List</b>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;<small><small><span id="contract_service_list_amount">Total <b>0</b></span></small></small></h4></div>
	        	<div class="float-left"><h4 class="m-0 text-light"><span id="id_contract_number"></span></h4></div>	        	
			    <div class="card-tools">
			 		<!--<button type="button" class="btn btn-tool" data-card-widget="maximize"><i class="fas fa-expand"></i></button>-->
			      	<button type="button" class="btn btn-tool" data-card-widget="collapse">ดูเพิ่มเติม<!--<i class="fas fa-minus"></i>--></button>
			    </div>

	      	</div>
	      	<div class="card-body">
			  <table id="contractServiceListTable" class="text-center">
			      <tr>
			        <td class="col-12">There is no contract service available.</td>
			      </tr>
			  </table>
	      	</div>
	    </div>
  			

      	<!-- Security Guard List -->      	
	    <div class="card card-security-guard-list card-outline card-success">

			<form id="security_guard_list_form" method="POST">
      		{% csrf_token %}

	      	<div class="card-header">

	        	<div class="float-left">
	        		<h4 class="m-0 text-dark" id="security_guard_list_title"><i class="fas fa-shield-alt fa-sm"></i>&nbsp;&nbsp;<b>Security Guard List</b>

	        			<!--&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;
		        		<button id="add_security_guard_button" type="button" class="btn btn-success btn-sm"><i class="fas fa-plus fa-sm"></i>&nbsp;&nbsp;{% trans 'New' %}&nbsp;</button>&nbsp;-->


	        		<!--
	        		<small><small>
					<div class="form-check form-check-inline">
		              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_active" value="1" checked>
		              <label class="form-check-label" for="id_security_guard_list_option_active">Active</label>
		            </div>
		            <div class="form-check form-check-inline">
		              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_pending" value="2">
		              <label class="form-check-label" for="id_security_guard_list_option_pending">Pending</label>
		            </div>
		            <div class="form-check form-check-inline">
		              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_all" value="3">
		              <label class="form-check-label" for="id_security_guard_list_option_all">All</label>
		            </div>		            
	            	</small></small>
	            	-->
					<!--&nbsp;|&nbsp;&nbsp;	
	        		<small><small>	        		
	        		<span id="security_guard_list_amount"><b>Total 0</b></span></small></small>-->
	        		</h4>
	        	</div>

	        	<div class="card-tools">
		        	<div class="card-tools float-right">
		        		<button id="cancel_security_guard_button" type="button" class="btn btn-secondary btn-sm">{% trans 'Cancel' %}</button>
		        		<button id="save_security_guard_button" type="button" class="btn btn-primary btn-sm"><i class="fas fa-save fa-sm"></i>&nbsp;&nbsp;{% trans 'Save' %}</button>
		        		&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
		        		<button id="add_security_guard_button" type="button" class="btn btn-success btn-sm"><i class="fas fa-plus fa-sm"></i>&nbsp;&nbsp;{% trans 'New' %}&nbsp;</button>&nbsp;&nbsp;
		        		
		        		<!--<button type="button" class="btn btn-tool text-dark" data-card-widget="maximize"><i class="fas fa-expand"></i></button>-->
		        		<!--<button id="expand_security_guard_window_button" type="button" class="btn btn-tool" data-card-widget="maximize"><i class="fas fa-expand"></i></button>-->
		        	</div>
	        	</div>	        

	      	</div>

	      	<div class="card-body">

	      		<font size='2pt'>
				<div class="row" style="white-space:nowrap;">

					<div class="col-8 float-left">

					  <div class="form-group row">

					  	<!--
					  	<div class="row col-2">

						  	<div class="col-12">
						  		<div id="employeePhoto"><img src="/static/img/profile-128x128.png" width="90px;" /></div>
						  	</div>
					  	</div>
						-->

					  	<div class="row col-12 d-flex justify-content-end">


						    <div class="col-3">
						    	<label class="form-check-label" for="id_emp_id"><b>Employee ID</b></label>
	                            <div class="input-group">                            	
	                              	<input type="number" id="id_emp_id" name="id_emp_id" class="form-control form-control-sm" value="" />
	                              	<button id="emp_id_lookup_button" type="button" class="btn btn-outline-primary btn-sm" data-toggle="modal" data-url=""><i class="fas fa-search fa-sm"></i></button>

	                              	<input type="hidden" id="id_selected_sch_no" name="id_selected_sch_no" value="0">
	                              	<input type="hidden" id="id_selected_service_id" name="id_selected_service_id" value="0">
	                              	
	                            </div>
						    </div>	 

						    <div class="col-5">
						    	<label class="form-check-label" for="id_emp_name_th"><b>Name</b></label>
						      	<input type="text" class="form-control form-control-sm" id="id_emp_name_th" placeholder="" readonly />
						    </div>

						    <div class="col-2">
						    	<label class="form-check-label" for="id_sch_rank"><b>Rank</b></label>
						      	<input type="text" class="form-control form-control-sm" id="id_sch_rank" placeholder="" readonly />
						    </div>


						    <div class="col-2">
						    	<label class="form-check-label" for="id_sch_rank"><b>Department</b></label>
						      	<input type="text" class="form-control form-control-sm" id="id_sch_dept" placeholder="" readonly />
						    </div>



						    <div class="col-6">
						    	<label class="form-check-label" for="id_emp_name_th"><b>Employee Status</b></label>
						    	<input type="text" class="form-control form-control-sm" id="id_emp_status" placeholder="" readonly />
						    </div>
						    <div class="col-3">
						    	<label class="form-check-label" for="id_emp_name_th"><b>Joined Date</b></label>
						      	<input type="text" class="form-control form-control-sm" id="id_emp_join_date" placeholder="" readonly />
						    </div>

						    <div class="col-3">
						    	<label class="form-check-label" for="id_emp_name_th"><b>Terminated Date</b></label>
						      	<input type="text" class="form-control form-control-sm" id="id_emp_term_date" readonly />
						    </div>	


						    <div class="col-5">
						    	<i class="far fa-calendar-alt"></i>&nbsp;<label class="form-check-label" for="id_duration_from"><b>Duration From</b></label>
						    	<div class="form-inline col-12 text-left float-left">
						      		<input type="checkbox" id="chkDurationFromDisable" class="form-inline float-left" onclick="disableDurationFormDP()">&nbsp;
						      		<input type="text" class="form-control form-control-sm" id="id_duration_from" placeholder="dd/mm/yyyy" />
						      	</div>
						    </div>					    
						    <div class="col-5">
						    	<i class="far fa-calendar-alt"></i>&nbsp;<label class="form-check-label" for="id_duration_to"><b>Duration To</b></label>
						    	<div class="form-inline col-12">
						    		<input type="checkbox" id="chkDurationToDisable" class="form-inline" onclick="disableDurationToDP()">&nbsp;
						      		<input type="text" class="form-control form-control-sm" id="id_duration_to" placeholder="dd/mm/yyyy" />
						      	</div>
						    </div>					    		    

						  	<div class="col-2">	   	
						  		<div><label class="form-label" for="id_sch_rank"><b>Service Status</b></label></div>
								<div class="form-check form-check-inline">
								  <input class="form-check-input" type="checkbox" id="id_service_active" value="1">
								  <label class="form-check-label" for="id_service_active"><b>Active</b></label>
								</div>
								<div class="form-check form-check-inline">
								  <input class="form-check-input" type="checkbox" id="id_relief">
								  <label class="form-check-label" for="id_relief"><b>Relief</b></label>
								</div>
							</div>


					  	</div>






					  </div>



					  <!--
					  <div class="form-group row">
					    <div class="col-6">
					    	<label class="form-check-label" for="id_emp_name_th"><b>Employee Status</b></label>
					    	<input type="text" class="form-control form-control-sm" id="id_emp_status" placeholder="" readonly />
					    </div>

					    <div class="col-3">
					    	<label class="form-check-label" for="id_emp_name_th"><b>Joined Date</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_emp_join_date" placeholder="" readonly />
					    </div>
					    <div class="col-3">
					    	<label class="form-check-label" for="id_emp_name_th"><b>Terminated Date</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_emp_term_date" readonly />
					    </div>					    
			
					  </div>
					  -->

					  <!--
					  <div class="form-group row">

					    <div class="col-4">
					    	<i class="far fa-calendar-alt"></i>&nbsp;<label class="form-check-label" for="id_duration_from"><b>Duration From</b></label>
					    	<div class="form-inline col-12 text-left float-left">
					      		<input type="checkbox" id="chkDurationFromDisable" class="form-inline float-left" onclick="disableDurationFormDP()">&nbsp;
					      		<input type="text" class="form-control form-control-sm" id="id_duration_from" placeholder="dd/mm/yyyy" />
					      	</div>
					    </div>					    
					    <div class="col-4">
					    	<i class="far fa-calendar-alt"></i>&nbsp;<label class="form-check-label" for="id_duration_to"><b>Duration To</b></label>
					    	<div class="form-inline col-12">
					    		<input type="checkbox" id="chkDurationToDisable" class="form-inline" onclick="disableDurationToDP()">&nbsp;
					      		<input type="text" class="form-control form-control-sm" id="id_duration_to" placeholder="dd/mm/yyyy" />
					      	</div>
					    </div>					    		    

					  	<div class="col-4">	   	
					  		<div><label class="form-label" for="id_sch_rank"><b>Service Status</b></label></div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="checkbox" id="id_service_active" value="1">
							  <label class="form-check-label" for="id_service_active"><b>Active</b></label>
							</div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="checkbox" id="id_relief">
							  <label class="form-check-label" for="id_relief"><b>Relief</b></label>
							</div>
						</div>

					  </div>
						-->

					  
					  <!--
					  <div class="form-group row">

						<div class="col-12"><label class="form-label" for="chkDurationFromDisable"><b>Duration From</b></label></div>
						<div class="form-inline col-12">
						    <div class="form-group">    	
						        <input type="checkbox" id="chkDurationFromDisable" onclick="disableDP()">&nbsp;
						        <input id="id_duration_from" type="text" class="form-control form-control-sm" placeholder="From" />
						    </div>
						</div>
					  </div>
					  -->

					</div>

					


					<div class="col-4">

						
						
						<div class="col-12 float-left">
							
							<div class="col-12">
								<div class="form-inline">
									<div class="text-center col-12"><b>SHIFT / WEEK</b>&nbsp;&nbsp;</div>									
		                        </div>								
							</div>




							<div class="text-left col-12 float-right p-0 m-0">

								<div class="form-inline col-12 p-0 m-0 float-right">
									<div class="text-right text-yellow col-2"><b>MON</b>&nbsp;</div>

									<div class="float-right text-right col-10 text-yellow">
		                          	<select name="id_mon_shift" class="form-control form-control-sm float-right" id="id_mon_shift" style="font-size:9pt;width:100% !important;">
			                          	<option value="99" class="text-dark">99&nbsp;&nbsp;&nbsp;# DAY OFF ##########</option> 
		                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
		                          	</select>
		                          	</div>
		                        </div>

								<div class="text-left form-inline col-12 p-0 m-0 pt-1">
									<div class="text-right text-pink col-2"><b>TUE</b>&nbsp;</div>
									<div class="float-right text-right col-10 text-pink">
		                          	<select name="id_tue_shift" class="form-control form-control-sm" id="id_tue_shift" style="font-size:9pt;width:100% !important;">
			                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF ##########</option> 
		                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
		                          	</select>
		                          	</div>
		                        </div>

								<div class="text-left form-inline col-12 p-0 m-0 pt-1">
									<div class="text-right text-green col-2"><b>WED</b>&nbsp;</div>
									<div class="float-right text-right col-10 text-green">
		                          	<select name="id_wed_shift" class="form-control form-control-sm" required="" id="id_wed_shift" style="font-size:9pt;width:100% !important;">
			                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF ##########</option> 
		                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
		                          	</select>
		                          	</div>
		                        </div>

								<div class="text-left form-inline col-12 p-0 m-0 pt-1">
									<div class="text-right text-orange col-2"><b>THU</b>&nbsp;</div>
									<div class="float-right text-right col-10 text-orange">
		                          	<select name="id_thu_shift" class="form-control form-control-sm" required="" id="id_thu_shift" style="font-size:9pt;width:100% !important;">
			                          	<option value="99" class="text-dark">99&nbsp;&nbsp;&nbsp;# DAY OFF ##########</option> 
		                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
		                          	</select>
		                          	</div>
		                        </div>

								<div class="text-left form-inline col-12 p-0 m-0 pt-1">
									<div class="text-right text-blue col-2"><b>FRI</b>&nbsp;</div>
									<div class="float-right text-right col-10 text-blue">
		                          	<select name="id_fri_shift" class="form-control form-control-sm" required="" id="id_fri_shift" style="font-size:9pt;width:100% !important;">
			                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF ##########</option> 
		                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
		                          	</select>
		                          	</div>
		                        </div>

								<div class="text-left form-inline col-12 p-0 m-0 pt-1">
									<div class="text-right text-purple col-2"><b>SAT</b>&nbsp;</div>
									<div class="float-right text-right col-10 text-purple">
		                          	<select name="id_sat_shift" class="form-control form-control-sm" required="" id="id_sat_shift" style="font-size:9pt;width:100% !important;">
			                          	<option value="99" class="text-dark">99&nbsp;&nbsp;&nbsp;# DAY OFF ##########</option> 
		                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
		                          	</select>
		                          	</div>
		                        </div>

								<div class="text-left form-inline col-12 p-0 m-0 pt-1">
									<div class="text-right text-red col-2"><b>SUN</b>&nbsp;</div>
									<div class="float-right text-right col-10 text-red">
		                          	<select name="id_sun_shift" class="form-control form-control-sm" required="" id="id_sun_shift" style="font-size:9pt;width:100% !important;">
			                          	<option value="99" class="text-dark">99&nbsp;&nbsp;&nbsp;# DAY OFF ##########</option> 
		                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
		                          	</select>
		                          	</div>
		                        </div>

	                        </div>                        	                        
						</div>
												

					</div>
					




	      		</div> 

	      		<hr>
	      		<!-- Filter -->
	      		<div class="row p-0">
	      			
	      			<div class="col-6 float-left pb-3">	      				

						<div class="form-check form-check-inline">
			              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_active" value="1" checked>
			              <label class="form-check-label text-primary" for="id_security_guard_list_option_active" style="font-size:1rem;padding:0 0 0 0;cursor: pointer">Active&nbsp;&nbsp;</label>
			            </div>
			            <div class="form-check form-check-inline">
			              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_pending" value="2">
			              <label class="form-check-label text-primary" for="id_security_guard_list_option_pending" style="font-size:1rem;padding:0 0 0 0;cursor: pointer">Pending&nbsp;&nbsp;</label>
			            </div>
			            <div class="form-check form-check-inline">
			              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_all" value="3">
			              <label class="form-check-label text-primary" for="id_security_guard_list_option_all" style="font-size:1rem;padding:0 0 0 0;cursor: pointer">All&nbsp;&nbsp;</label>

			              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<span id="security_guard_list_amount">TOTAL <b>0</b></span>
			            </div>			            

		        	</div>

		        	<div class="col-6 card-tools text-right pb-2">

						<div class="input-group-append float-right">
							<input type="text" class="form-control form-control-xs w-200 border-success" placeholder="Filter Data" id="employee_search_text" style="border-top-right-radius:0px;border-bottom-right-radius:0px;" autocomplete="off">
							<button class="btn btn-success btn-xs" type="button"  id="employee_search_clear_button" style="border-style: none none none none; border-top-left-radius:0px;border-bottom-left-radius:0px;">CLEAR</button>

							<!--
			        		<span class='pl-2 pt-1 pr-2'>&nbsp;&nbsp;|&nbsp;&nbsp;</span><button id="print_scuedule_button" type="button" class="btn btn-primary btn-xs float-right">&nbsp;&nbsp;<i class="fas fa-print fa-sm"></i>&nbsp;&nbsp;{% trans 'Print' %}&nbsp;&nbsp;</button>
							-->

							<span class='pl-2 pt-1 pr-2'>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
				            <ol class="breadcrumb float-sm-right p-0">
				              <li>
				                <button class="btn btn-outline-info btn-xs dropdown-toggle" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				                  &nbsp;&nbsp;<i class="fas fa-print fa-sm"></i>&nbsp;&nbsp;Print
				                </button>
				                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink"> 
				                  <span style="font-size: 14px;">
				                  <a class="dropdown-item" href="#" onclick="print_document();"><i class="fas fa-desktop text-secondary"></i>&nbsp;&nbsp;Display on screen</a>                  
				                  <a class="dropdown-item" href="#" onclick="export_to_excel();"><i class="far fa-file-excel text-secondary"></i>&nbsp;&nbsp;Export to Excel</a>
				                  </span>
				                </div>
				              </li>

				            </ol>
						</div>
						
		        		
		        	</div>

	      		</div>



	      		<div class="col-12 table-responsive table-striped p-0">
	      			<font size="2">
					<table class='table table-sm dataTable' id="id_security_guard_list" style="white-space: nowrap;">
					<thead>
					<tr>
					<th scope='col'>No</th>
					<th scope='col'>EMP ID</th>
					<th scope='col'>Name</th>
					<th scope='col'>Rank</th>
					<th scope='col'>Eff From</th>
					<th scope='col'>Eff To</th>
					<th scope='col' class='text-center'>MON</th>
					<th scope='col' class='text-center'>TUE</th>
					<th scope='col' class='text-center'>WED</th>
					<th scope='col' class='text-center'>THU</th>
					<th scope='col' class='text-center'>FRI</th>
					<th scope='col' class='text-center'>SAT</th>
					<th scope='col' class='text-center'>SUN</th>
					<th scope='col' class='text-center'>Active</th>
					<th scope='col'>Relief</th>
					<th scope='col'>Update Date</th>
					<th scope='col'>Update By</th>
					<th scope='col'>Update Flag</th>
					<th scope='col'>&nbsp;</th>
					</tr>
					</thead>
					<tbody>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
						</tr>
					</tbody>
					</table>
					</font>
				</div>
			<!--
              <div class="overlay">
                <i class="fas fa-2x fa-sync-alt"></i>
              </div>
			-->

	      	</div>

	      	</form>

	    </div>

		<div class="clearfix">&nbsp;</div>

    </section>
    <!-- /.content -->






	<!-- Add security guard modal -->
	<div class="modal fade" id="add_security_guard_modal" tabindex="-1" role="dialog">

	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      
	      <div class="modal-header">
	        <h5 class="modal-title" id="exampleModalLongTitle"><i class="fas fa-plus fa-sm text-secondary"></i>&nbsp;&nbsp;<strong>{% trans 'Add new guard' %}</strong></h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      
	      <div class="modal-body"></div>

	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary btn-md" data-dismiss="modal">{% trans 'Close' %}</button>
	        <button id="save_security_guard_button" type="button" class="btn btn-primary btn-md"><i class="fas fa-save fa-sm"></i>&nbsp;&nbsp;{% trans 'Save' %}&nbsp;&nbsp;</button>
	      </div>
	    </div>
	  </div>
	</div>



	<!-- Select employee modal -->
	<div class="modal fade" id="select_employee_modal" tabindex="-1" role="dialog">

	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      
	      <div class="modal-header bg-primary">
	        <h5 class="modal-title"><i class="fas fa-search fa-sm text-light"></i>&nbsp;&nbsp;{% trans 'Select an Employee' %}</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      
	      <div class="modal-body"></div>

	      <!--
	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary btn-md" data-dismiss="modal">{% trans 'Close' %}</button>	        
	      </div>
	  	  -->

	    </div>
	  </div>
	</div>

  </div>
  <!-- /.content-wrapper -->

{% endblock %}


{% block javascript %}
<script>	

var table = $('#id_security_guard_list').DataTable({
  "paging": false,
  "pageLength": 15,
  "scrollCollapse": true,
  "lengthChange": false,
  "searching": true,
  "ordering": true,
  "info": false,
  "autoWidth": true,
  "dom": '<"top"i>rt<"bottom"><"clear">',
  "search": "_INPUT_",
  "searchPlaceholder": "Search",  
  "language": {
    search: '<i class="fa fa-filter" aria-hidden="true"></i>',
    searchPlaceholder: 'Filter data'
  },
  "columnDefs": [
  	{"targets": 0, "orderable": true},
  	{"targets": 1, "orderable": true},
  	{"targets": 2, "orderable": true},
  	{"targets": 3, "orderable": false},
  	{"targets": 4, "orderable": false},
  	{"targets": 5, "orderable": false},
  	{"targets": 6, "orderable": false},
  	{"targets": 7, "orderable": false},
  	{"targets": 8, "orderable": false},
  	{"targets": 9, "orderable": false},
  	{"targets": 10, "orderable": false},
  	{"targets": 11, "orderable": false},
  	{"targets": 12, "orderable": false},
  	{"targets": 13, "orderable": false},
  	{"targets": 14, "orderable": false},
  	{"targets": 15, "orderable": false},
  	{"targets": 16, "orderable": false},
  	{"targets": 17, "orderable": false},
  	{"targets": 18, "orderable": false},
  ],
  buttons: [
    {
        extend: 'print',
        title: '',
        exportOptions: {
          columns: [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
        }
    },
    {
        extend: 'excelHtml5',        
        title: '',
        exportOptions: {
          columns: [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
        }
    },
  ]
});

function print_document() {  
  $(".buttons-print").trigger("click");
}

function export_to_excel() {
  $(".buttons-excel").trigger("click");  
}

$('#select_employee_modal').on('shown.bs.modal', function () {
    $('#id_employee_search_text').focus();
})

$(document).on('keyup keypress', '#search_employee_modal_form input[type="text"]', function(e) {
	if(e.which == 13) {
	  e.preventDefault();
	  return false;
	}
});

$(document).on('keypress', '#id_employee_search_text', function(e) {
	if(e.which == 13) {
	  	search_key = $("#id_employee_search_text").val();
	  	if(search_key.length == 0 || search_key=="") {
	  		alert("Please enter data");
	  		$("#id_employee_search_text").focus();
	  		return false;
	  	} else {
	  		search_employee_modal();
	  	}

		e.preventDefault();
	}
});

// id_emp_id
$(document).on('keypress', '#id_emp_id', function(e) {
	if(e.which == 13) {      
		e.preventDefault();

		cus_id = $('#id_cus_id').val();
		cus_brn = $('#id_cus_brn').val();
		cus_vol = $('#id_cus_vol').val();
		
		if(cus_id=="") {
			alert("Please entet Customer ID.");
			$('#id_cus_id').focus();				
			return false;
		}

		if(cus_brn=="") {
			alert("Please entet Customer Branch.");
			$('#id_cus_brn').focus();
			return false;			
		}

		if(cus_vol=="") {
			alert("Please entet Customer Volume.");
			$('#id_cus_vol').focus();
			return false;
		}

		emp_id = $(this).val();



		if(emp_id=="") {
		  	$(document).Toasts('create', {
		    	class: "bg-danger", 
		    	title: "{% trans 'System message' %}",
		    	subtitle: '',
		    	autohide: true,
		    	delay: 2000,
		    	body: "Please enter Employee ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
		    	autoDismiss: true,
		    	close: true,
		    	autoremove: true,
		  	});    		
    		$("#id_emp_id").focus();
		} else {
					
			$.ajax({
		    	url : "/monitoring/ajax/get_employee",
		    	type : "GET",
		    	data : {          
		      		csrfmiddlewaretoken: '{{ csrf_token }}',
		      		emp_id: emp_id,
		      		cus_id: cus_id,
		      		cus_brn: cus_brn,
		      		cus_vol: cus_vol,
		    	},
		    	success: function(data) {
	    			$("#id_emp_name_th").val("");
	    			$("#id_sch_rank").val("");
	    			$("#id_sch_dept").val("");
	    			$("#id_emp_status").val("");
	    			$("#id_emp_join_date").val("");
	    			$("#id_emp_term_date").val("");
		    		$("#id_emp_name_th").css("background-color", '');
		    		$("#id_emp_name_th").animate({color:''}, 1000);
		    		$("#employeePhoto").html("<img src='/static/img/profile-128x128.png' width='90px;'' />");

		    		if(data.is_found) {
						$("#employeePhoto").html("<img src='data:image/png;base64," + data.employee_photo + "' style='width:90px;'/>");
		    			$("#id_emp_name_th").val(data.emp_fname_th.trim() + "  " + data.emp_lname_th.trim());
		    			$("#id_sch_rank").val(data.emp_rank);
		    			$("#id_sch_dept").val(data.emp_type);

		    			$("#id_emp_status").val(data.emp_status);
		    			if(data.emp_status_id=='9') {		    				
			    			$("#id_emp_status").animate({color:'red'}, 1000);
		    			} else {
		    				$("#id_emp_status").animate({color:'#495057'}, 1000);
		    			}
		    			$("#id_emp_join_date").val(data.emp_join_date);
		    			$("#id_emp_term_date").val(data.emp_term_date);

			    		$("#id_emp_name_th").css("background-color", 'green');
			    		$("#id_emp_name_th").animate({color:'white'}, 1000);
		    		} else {

					  	$(document).Toasts('create', {
					    	class: "bg-danger", 
					    	title: "{% trans 'System message' %}",
					    	subtitle: '',
					    	autohide: true,
					    	delay: 2000,
					    	body: "Employee ID not found.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
					    	autoDismiss: true,
					    	close: true,
					    	autoremove: true,
					  	});
		    		}
		    		$.LoadingOverlay("hide");
		    		$("#id_emp_id").select();
		    	},
		    });
		}		
	}
});

document.onkeydown = function(e) {
  if(event.keyCode == 123) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
     return false;
  }
}

$(document).ready(function(){
 	$('#add_security_guard_button').on('click', function (e) {
 		
 		$("#id_selected_sch_no").val(0);
    	$("#id_selected_service_id").val(0);

		$("#security_guard_list_form").trigger("reset");
		$("#save_security_guard_button").attr("disabled", false);
		
		$("#id_emp_id").attr("disabled", false);
		$("#emp_id_lookup_button").attr("disabled", false);
		$("#cancel_security_guard_button").attr("disabled", false);

		$("#chkDurationFromDisable").attr("disabled", false);
		$("#id_duration_from").attr("disabled", false);
		$("#chkDurationToDisable").attr("disabled", false);
		$("#id_duration_to").attr("disabled", false);
		$("#id_service_active").attr("disabled", false);
		$("#id_relief").attr("disabled", false);

    	$('#id_duration_from').datepicker({format: 'dd/mm/yyyy',altField: '#thealtdate',altFormat: 'dd/mm/yyyy'}).datepicker("setDate", new Date());
    	$('#id_duration_to').datepicker({format: 'dd/mm/yyyy',altField: '#thealtdate',altFormat: 'dd/mm/yyyy'}).datepicker("setDate", new Date());

		$("#id_mon_shift").attr("disabled", false);
		$("#id_tue_shift").attr("disabled", false);
		$("#id_wed_shift").attr("disabled", false);
		$("#id_thu_shift").attr("disabled", false);
		$("#id_fri_shift").attr("disabled", false);
		$("#id_sat_shift").attr("disabled", false);
		$("#id_sun_shift").attr("disabled", false);

		$("#id_emp_name_th").css("background-color", '');
    	$("#id_emp_name_th").animate({color:''}, 1000);
		
		
    	$("#employeePhoto").html("<img src='/static/img/profile-128x128.png' width='90px;'' />");
		
		$("#id_emp_id").focus();		
    });

	$("#contract_service_list_form :input").attr("disabled", true);
	$("#security_guard_list_form :input").prop("disabled", true);

	$("#id_cus_id").on('click', function(){
		$("#id_cus_id").select();
	});
	$("#id_cus_brn").on('click', function(){
		$("#id_cus_brn").select();
	});
	$("#id_cus_vol").on('click', function(){
		$("#id_cus_vol").select();
	});

	$('#id_cus_id').focus();
	$("#id_cus_id").select();

 	$("#cancel_security_guard_button").click( function() {
    	event.preventDefault();
    	reset_security_guard_list_form();
    });

 	$("#emp_id_lookup_button").click( function(e) {
 		var result = "";
 		emp_id = $("#id_emp_id").val();
 		page = 1;

		var search_key = "";
		var search_option = 1;
 		
		$.ajax({
        	url: "/monitoring/ajax/get_employee_list",        	
			type: 'get',          
          	dataType: 'json',
          	data : { 
            	emp_id : emp_id,
            	page: page,
          	},          
			success: function (data) {
				var result = "";
				var count = data.results.length;

				result += "<div class='row col-12'>";
				result += "<div class='col-8 offset-3 pb-2'>";
				result += "<form id='search_employee_modal_form' class='form-inline col-12' accept-charset='UTF-8'>";
				result += "  <div class='form-group mx-sm-3 mb-2'>";
				result += "  <select name='employee_option' class='form-control form-control-sm' required id='id_employee_option'>";
				result += "    <option value='1' selected>Employee ID</option>";
				result += "    <option value='2'>Employee Name (TH)</option>";
				result += "    <option value='3'>Employee Name (EN)</option>";
				result += "  </select>&nbsp;&nbsp;&nbsp;&nbsp;";
				result += "    <label for='id_employee_search_text' class='sr-only'>Search</label>";            
				result += "    <input type='text' class='form-control form-control-sm' id='id_employee_search_text' name='employee_search_text' placeholder=''>";
				result += "  </div>";
				result += "<a href='javascript:search_employee_modal()' type='button' class='btn btn-primary btn-sm mb-2'>Search</a>";            
				result += "</form>";
				result += "</div>";


				result += "<div class='col-12 pl-3'>";
				
				result += "<font size='2'>";

				result += "<table class='table table-sm table-hover'>";
				
				result += " <thead>";
				result += "   <tr>";
				result += "     <th scope='col'>{% trans 'Employee ID' %}</th>";
				result += "     <th scope='col'>{% trans 'First Name (TH)' %}</th>";
				result += "     <th scope='col'>{% trans 'Last Name (TH)' %}</th>";
				result += "     <th scope='col'>&nbsp;</th>";
				result += "   </tr>";
				result += " </thead>";
				result += "<tbody>";
				result += "</div>";

				result += "<div>";

				for(var i=0; i<count; i++) {              
				  var emp_id = data.results[i]["emp_id"];
				  var emp_fname_th = data.results[i]["emp_fname_th"].trim();
				  var emp_lname_th = data.results[i]["emp_lname_th"].trim();
				  var emp_fname_en = data.results[i]["emp_fname_en"].trim();
				  var emp_lname_en = data.results[i]["emp_lname_en"].trim();
				  var emp_join_date = data.results[i]["emp_join_date"]
				  var emp_term_date = data.results[i]["emp_term_date"]
				  var emp_rank = data.results[i]["emp_rank"]
				  var emp_type = data.results[i]["emp_type"]
				  var emp_status = data.results[i]["emp_status"]

				  result += "<tr>";
				  result += "<td>" + emp_id + "</td>";
				  result += "<td>" + emp_fname_th + "</td>";
				  result += "<td>" + emp_lname_th + "</td>";
				  
				  result += "<td><a href='javascript:select_employee(" + emp_id + ",\"" + emp_fname_th + "\",\"" + emp_lname_th + "\",\"" + emp_join_date + "\",\"" + emp_term_date + "\",\"" + emp_rank + "\",\"" + emp_type + "\",\"" + emp_status + "\");' type='button' class='btn btn-outline-primary btn-sm'>Select</a></td>";

				  result += "</tr>";            
				}
				result += " </tbody>";
				result += "</table>";
				result += "</font>";


				if(data.is_paginated) {
				  result += "<div class='text-center'>";
				  result += "  <span>";
				  result += data.current_page_number + " of " + data.current_page_paginator_num_pages;
				  result += "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:get_next_page(" + data.next_page + ");'>" + "<i class='fas fa-arrow-circle-right'></i></a>";
				  result += "    </span>";
				  result += "</div>";
				}

				$("#select_employee_modal .modal-body").html(result);
				$("#id_employee_search_text").focus();


	        },          	
          	error: function (data) {
          		result += "Error";
          	},
         });
    	
    	$("#select_employee_modal").modal("show");
	});

 	$("#save_security_guard_button").click( function() {
    	event.preventDefault();    	

		emp_id = $("#id_emp_id").val();
		selected_sch_no = $("#id_selected_sch_no").val();
		selected_service_id = $("#id_selected_service_id").val();
		duration_from =  $("#id_duration_from").val();
		duration_to =  $("#id_duration_to").val();
		contract_list_filter_option = $('input[type=radio][name=security_guard_list_status_option]:checked').val();
		
    	if (emp_id=="") {
		  	$(document).Toasts('create', {
		    	class: "bg-danger", 
		    	title: "{% trans 'System message' %}",
		    	subtitle: '',
		    	autohide: true,
		    	delay: 2000,
		    	body: "Please enter Employee ID.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
		    	autoDismiss: true,
		    	close: true,
		    	autoremove: true,
		  	});		
    		$("#id_emp_id").focus();
    		return false;
    	}

		if(selected_service_id==0) {
		  	$(document).Toasts('create', {
		    	class: "bg-danger", 
		    	title: "{% trans 'System message' %}",
		    	subtitle: '',
		    	autohide: true,
		    	delay: 2000,
		    	body: "Please select a service from <b>Contract Service List</b>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
		    	autoDismiss: true,
		    	close: true,
		    	autoremove: true,
		  	});

			return false;
		}

		if(duration_from=="") {
		  	$(document).Toasts('create', {
		    	class: "bg-danger", 
		    	title: "{% trans 'System message' %}",
		    	subtitle: '',
		    	autohide: true,
		    	delay: 2000,
		    	body: "Please select Duration From.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
		    	autoDismiss: true,
		    	close: true,
		    	autoremove: true,
		  	});
    		$("#chkDurationFromDisable").focus();			
			return false;			
		}

		if(duration_to=="") {
		  	$(document).Toasts('create', {
		    	class: "bg-danger", 
		    	title: "{% trans 'System message' %}",
		    	subtitle: '',
		    	autohide: true,
		    	delay: 2000,
		    	body: "Please select Duration To1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
		    	autoDismiss: true,
		    	close: true,
		    	autoremove: true,
		  	});
    		$("#id_duration_to").focus();			
			return false;			
		}

		//alert(duration_to);
		//return false;

		durationFromStatus =  $("#chkDurationFromDisable").is(":checked");
		if(!durationFromStatus) {
		  	$(document).Toasts('create', {
		    	class: "bg-danger", 
		    	title: "{% trans 'System message' %}",
		    	subtitle: '',
		    	autohide: true,
		    	delay: 2000,
		    	body: "Please select Duration From.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
		    	autoDismiss: true,
		    	close: true,
		    	autoremove: true,
		  	});
    		$("#id_duration_from").focus();			
			return false;				
		}

		durationToStatus =  $("#chkDurationToDisable").is(":checked");
		if(!durationToStatus) {
			if(duration_to=="") {
			  	$(document).Toasts('create', {
			    	class: "bg-danger", 
			    	title: "{% trans 'System message' %}",
			    	subtitle: '',
			    	autohide: true,
			    	delay: 2000,
			    	body: "Please select Duration To.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
			    	autoDismiss: true,
			    	close: true,
			    	autoremove: true,
			  	});
	    		$("#id_duration_to").focus();
				return false;								
			} else {
				duration_to = '31/12/2999';
			}

		}

		// Check Duration From must be greater than today
		var today = new Date();
		var dd = String(today.getDate()).padStart(2, '0');
		var mm = String(today.getMonth() + 1).padStart(2, '0');
		var yyyy = today.getFullYear();	
		today = dd + '/' + mm + '/' + yyyy;

		duration_from = moment(duration_from, "DD/MM/YYYY");
		today = moment(today, "DD/MM/YYYY");

		if($('#chkDurationFromDisable').prop('disabled')) {
			//alert("disabled");
		} else {
			//alert("not disabled");
			if (duration_from <= today) {
			  	$(document).Toasts('create', {
			    	class: "bg-danger", 
			    	title: "{% trans 'System message' %}",
			    	subtitle: '',
			    	autohide: true,
			    	delay: 2000,
			    	body: "Duration From must be greater than today.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
			    	autoDismiss: true,
			    	close: true,
			    	autoremove: true,
			  	});
				$("#id_duration_from").focus();
				return false;
			}

		}


    	if ($('#id_service_active').is(":checked")) {
	    	service_active = 1;
    	} else {
    		service_active = 0;
    	}

    	if ($('#id_relief').is(":checked")) {
	    	relief = 1;
    	} else {
    		relief = 0;
    	}

		$.ajax({
	    	url : "/monitoring/ajax/save_customer_schdule_plan/",
	    	type : "POST",
	    	data : {          
	      		csrfmiddlewaretoken: '{{ csrf_token }}',
	      		cus_id: $("#id_cus_id").val(),
	      		cus_brn: $("#id_cus_brn").val(),
	      		cus_vol: $("#id_cus_vol").val(),
	      		selected_sch_no: $("#id_selected_sch_no").val(),
	      		selected_service_id: $("#id_selected_service_id").val(),
	      		emp_id: $("#id_emp_id").val(),
	      		emp_rank: $("#id_sch_rank").val(),
	      		sch_active: service_active,
	      		relief: relief,
	      		mon_shift: $("#id_mon_shift").val(),
	      		tue_shift: $("#id_tue_shift").val(),
	      		wed_shift: $("#id_wed_shift").val(),
	      		thu_shift: $("#id_thu_shift").val(),
	      		fri_shift: $("#id_fri_shift").val(),
	      		sat_shift: $("#id_sat_shift").val(),
	      		sun_shift: $("#id_sun_shift").val(),
	      		duration_from: $("#id_duration_from").val(),
	      		duration_to: duration_to,
	      		contract_list_filter_option: $('input[type=radio][name=security_guard_list_status_option]:checked').val(),
	    	},
	    	success: function(data) {
			  	if(data.is_saved) {
					// Security Guard List
					/*
					result = "";
					result += "<font size='2'>";
					result += "<table class='table table-striped table-sm'>";
					result += "  <thead>";
					result += "    <tr>";
					result += "      <th scope='col'>No..</th>";
					result += "      <th scope='col'>Name</th>";
					result += "      <th scope='col'>Rank</th>";
					result += "      <th scope='col'>Eff From</th>";
					result += "      <th scope='col'>Eff To</th>";
					result += "      <th scope='col' class='text-center'>MON</th>";
					result += "      <th scope='col' class='text-center'>TUE</th>";
					result += "      <th scope='col' class='text-center'>WED</th>";
					result += "      <th scope='col' class='text-center'>THU</th>";
					result += "      <th scope='col' class='text-center'>FRI</th>";
					result += "      <th scope='col' class='text-center'>SAT</th>";
					result += "      <th scope='col' class='text-center'>SUN</th>";
					result += "      <th scope='col' class='text-center'>Active</th>";
					result += "      <th scope='col'>Relief</th>";
					result += "      <th scope='col'>Update Date</th>";
					result += "      <th scope='col'>Update By</th>";
					result += "      <th scope='col'>Update Flag</th>";
					result += "		 <th scope='col'>&nbsp;</th>";
					result += "    </tr>";
					result += "  </thead>";					
					result += "  <tbody>";
					*/

					result = "";
					if(data.sch_plan_list.length>0) {
						count = 1;
						for(i=0; i<data.sch_plan_list.length; i++) {
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b></a></b></td>";
							result += "      <td><b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";

							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_mon"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_tue"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_wed"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_thu"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_fri"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_sat"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_sun"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";


							if(data.sch_plan_list[i]["sch_active"]==1)
								result += "      <td class='text-center text-success'>Yes</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1)
								result += "      <td class='text-center text-success'>Yes</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							
							//result += "      <td class='text-center align-center'>" + data.sch_plan_list[i]["upd_flag"] + ".</td>";
							result += "      <td class='text-center align-center'>...</td>";
							
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        result += "		   </div>";
					        result += "		 </td>";
							result += "    </tr>";						
							count++;
						}						
					} else {
						result += "<tr><td colspan='19' align='center'>There is no data available.</td></tr>";
					}

					//result += "  </tbody>";


					//result += "</table>";
					//result += "</font>";
						
					reset_security_guard_list_form();		

					//$("#id_security_guard_list tbody").html(result);
					refresh_table(result);

				  	$(document).Toasts('create', {
				    	class: data.class,
				    	title: "{% trans 'System message' %}",
				    	subtitle: '',
				    	autohide: true,
				    	delay: 2000,
				    	body: data.message + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
				    	autoDismiss: true,
				    	close: true,
				    	autoremove: true,
				  	});
			  	} else {					
					$.alert({
					    title: 'Error',
					    type: 'red',
					    content: data.message,
					    //theme: 'black',
					    animation: 'zoom',
					    animationBounce: 1.5,
					    closeIcon: false,
					    //title: false,
					    boxWidth: '38%',
					    useBootstrap: false,
					});
			  	}

	    	},
	    	error: function(data) {
			  	$(document).Toasts('create', {
			    	class: "bg-danger", 
			    	title: "{% trans 'Error message' %}",
			    	subtitle: '',
			    	autohide: true,
			    	delay: 2000,
			    	body: data.message + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
			    	autoDismiss: true,
			    	close: true,
			    	autoremove: true,
			  	});	    		
	    	}
	    });

    });

 	$("#cancelCustomerServicePersonButton").click( function() {
    	event.preventDefault();    	

    	$("#id_selected_sch_no").val(0);

    	$("#schedule_maintenance_form :input").attr("disabled", false);
    	
    	$("#schedule_maintenance_form").trigger("reset");
    	$("#contract_service_list_form").trigger("reset");
		$("#security_guard_list_form").trigger("reset");

    	$('#contract_service_persion_list_form').trigger("reset");		    	
		//$("#customer_name_title").html("");
		$("#contract_service_list_form :input").attr("disabled", true);
		$("#security_guard_list_form :input").attr("disabled", true);
		$("#contract_service_list_form").trigger("reset");

		$(".card-contract-service-list .card-body").html("");
		
		//$(".card-security-guard-list .card-body").html("");
		$("#id_security_guard_list tbody").html("");

		$("#contract_service_list_amount").html("Total <b>0</b>");
		$("#security_guard_list_amount").html("Total <b>0</b>");

		$("#customer_name_title").html("<h4 class='m-0'><b>Customer Information</b></h4>");		
		$("#employeePhoto").html("<img src='/static/img/profile-128x128.png' width='90px;'' />");

		//$("#id_cus_main_cus_name_th").css("background-color", '');
		//$("#id_cus_main_cus_name_th").animate({color:''}, 1000);					
		$("#id_emp_name_th").css("background-color", '');
		$("#id_emp_name_th").animate({color:''}, 1000);		

		$('#id_duration_from').datepicker({format: 'dd/mm/yyyy',altField: '#thealtdate',altFormat: 'dd/mm/yyyy',autoclose: true}).datepicker("setDate", new Date());
    	$('#id_duration_to').datepicker({format: 'dd/mm/yyyy',altField: '#thealtdate',altFormat: 'dd/mm/yyyy',autoclose: true}).datepicker("setDate", new Date());

    	$("#id_cus_id").focus();
    	$("#id_cus_id").select();
  	});

 	/*
 	$("#saveSecurityGuardButton").click( function() {
    	event.preventDefault();
    	alert("todo");
    });
 	*/
 	

	$('input[type=radio][name=security_guard_list_status_option]').change(function() {
			
		showLoading();
		
		// Security Guard List
	    if (this.value == '1') {

			$.ajax({
	        	url : "/monitoring/ajax/get_customer_schdule_plan_list/",
	        	type : "POST",
	        	async: true,
	        	data : {          
	          		csrfmiddlewaretoken: '{{ csrf_token }}',
	          		cus_id: $("#id_cus_id").val(),
	          		cus_brn: $("#id_cus_brn").val(),
	          		cus_vol: $("#id_cus_vol").val(),
	          		sch_active: this.value
	        	},
	        	success: function(data) {
	        		total = data.sch_plan_list.length;

					if(total>0) {
						count = 1;
						result = "";
						for(i=0; i<total; i++) {								
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							

							//result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b></a></b></td>";
							result += "      <td><b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";

							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_mon"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_tue"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";							

							if(data.sch_plan_list[i]["sch_shf_wed"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_thu"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";							
							
							if(data.sch_plan_list[i]["sch_shf_fri"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_sat"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_sun"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";

							if(data.sch_plan_list[i]["sch_active"]==1) {
								//result += "      <td class='text-center text-success'>Yes</td>";
								result += "      <td class='text-center text-success'><span class='badge badge-success'>active</span></td>";
							}

							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1) {
								result += "      <td class='text-center text-success'><span class='badge badge-success'>active</span></td>";
							}
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["upd_flag"] + "</td>";

							//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";			
							count++;
						}

						//$("#id_security_guard_list tbody").html(result);
						refresh_table(result);

						$("#security_guard_list_amount").html("Total <b>" + total + "</b>");
						$.LoadingOverlay("hide");

					} else {
						result = "<tr><td colspan='18' align='center'>There is no data available.</td></tr>";
						//$("#id_security_guard_list tbody").html(result);
						refresh_table(result);

						$("#security_guard_list_amount").html("Total <b>0</b>");
						$.LoadingOverlay("hide");
					}
										
	        	},
	        	error: function(data) {	        		
	          		result = "<tr><td colspan='19' align='center'>There is no data available.</td></tr>";

					if(count > 0)
						count = count - 1;

					$("#id_security_guard_list tbody").html(result);
					refresh_table(result);

					$("#security_guard_list_amount").html("Total <b>0</b>");
					$.LoadingOverlay("hide");
	        	}	        	
	        });			
	    }
	    else if (this.value == '2') {
			
			$("#id_security_guard_list tobdy").html("Loading...");
			$("#security_guard_list_amount").html("Total <b>0</b>");
			$.ajax({

	        	url : "/monitoring/ajax/get_customer_schdule_plan_list/",
	        	type : "POST",
	        	async: true,
	        	data : {          
	          		csrfmiddlewaretoken: '{{ csrf_token }}',
	          		cus_id: $("#id_cus_id").val(),
	          		cus_brn: $("#id_cus_brn").val(),
	          		cus_vol: $("#id_cus_vol").val(),
	          		sch_active: this.value
	        	},
	        	success: function(data) {
	        		total = data.sch_plan_list.length;
					if(total>0) {
						count = 1;
						result = "";
						for(i=0; i<total; i++) {								
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							
							//result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] +"'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b></a></b></td>";
							result += "      <td><b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";


							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";


							if(data.sch_plan_list[i]["sch_shf_mon"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_tue"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";							

							if(data.sch_plan_list[i]["sch_shf_wed"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_thu"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";							
							
							if(data.sch_plan_list[i]["sch_shf_fri"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_sat"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_sun"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";

							if(data.sch_plan_list[i]["sch_active"]==1) {
								//result += "      <td class='text-center text-success'>Yes</td>";
								result += "      <td class='text-center text-success'><span class='badge badge-success'>active</span></td>";
							}
							else {
								result += "      <td class='text-center'>&nbsp;</td>";								
							}

							if(data.sch_plan_list[i]["relief"]==1)
								result += "      <td class='text-center text-success'>Yes</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["upd_flag"] + "</td>";
														//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";						
							count++;
						}

						$("#id_security_guard_list tbody").html(result);
						refresh_table(result);

						$("#security_guard_list_amount").html("Total <b>" + total + "</b>");
						$.LoadingOverlay("hide");

					} else {
						result = "<tr><td colspan='18' align='center'>There is no data available.</td></tr>";
						//$("#id_security_guard_list tbody").html(result);
						refresh_table(result);

						$("#security_guard_list_amount").html("Total <b>0</b>");
						$.LoadingOverlay("hide");
					}
					
	        	},
	        	error: function(data) {	        		
	          		result += "<tr><td colspan='19' align='center'>There is no data available.</td></tr>";
					$("#id_security_guard_list tbody").html(result);
					refresh_table(result);
					$("#security_guard_list_amount").html("Total <b>0</b>");
					
					$.LoadingOverlay("hide");					
	        	}   	
	        });
	    } else if (this.value == '3') {			
			
			$.ajax({
	        	url : "/monitoring/ajax/get_customer_schdule_plan_list/",
	        	type : "POST",
	        	async: true,
	        	data : {          
	          		csrfmiddlewaretoken: '{{ csrf_token }}',
	          		cus_id: $("#id_cus_id").val(),
	          		cus_brn: $("#id_cus_brn").val(),
	          		cus_vol: $("#id_cus_vol").val(),
	          		sch_active: this.value
	        	},
	        	success: function(data) {	        		
	        		total = data.sch_plan_list.length;
					if(total>0) {
						count = 1;
						result = "";
						for(i=0; i<total; i++) {
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							
							//result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b></a></b></td>";
							result += "      <td><b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";

							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_mon"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_tue"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";							

							if(data.sch_plan_list[i]["sch_shf_wed"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_thu"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";							
							
							if(data.sch_plan_list[i]["sch_shf_fri"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_sat"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_sun"]==99)
								result += "      <td class='text-center text-danger'>OFF</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";

							if(data.sch_plan_list[i]["sch_active"]==1) {
								//result += "      <td class='text-center text-success'>Yes</td>";
								result += "      <td class='text-center text-success'><span class='badge badge-success'>active</span></td>";
							}
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1) {								
								//result += "      <td class='text-center text-success'>Yes</td>";
								result += "      <td class='text-center text-success'><span class='badge badge-success'>active</span></td>";
							}
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["upd_flag"] + "</td>";
														//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";						
							count++;
						}

						//$("#id_security_guard_list tbody").html(result);
						refresh_table(result);

						$("#security_guard_list_amount").html("Total <b>" + total + "</b>");							
						$.LoadingOverlay("hide");
					} else {
						result = "<tr><td colspan='19' align='center'>There is no data available.</td></tr>";
						refresh_table(result);

						$("#security_guard_list_amount").html("Total <b>0</b>");
						$.LoadingOverlay("hide");
					}
					
	        	},
	        	error: function(data) {	        		
	          		result = "<tr><td colspan='19' align='center'>There is no data available.</td></tr>";
					refresh_table(result);
					$("#security_guard_list_amount").html("Total <b>0</b>");		          		
					$.LoadingOverlay("hide");					
	        	},	        
	        });	       	
	    } else {
	    	result += "<tr><td colspan='18' align='center'>There is no data available.</td></tr>";
			$("#id_security_guard_list tbody").html(result);
			$("#security_guard_list_amount").html("Total <b>0</b>");		    	
			$.LoadingOverlay("hide");
	    }

	});
	
	

});

$(document).on('keypress', '#id_cus_id', function(e) {
	if(e.which == 13) {      
		e.preventDefault();

		var obj = $(this);
      	var id_cus_id = obj.val();
      	while (id_cus_id.length < 7) 
        	id_cus_id = "0" + id_cus_id;      	
      	$('#id_cus_id').val(id_cus_id);

		$('#id_cus_brn').focus();
		$('#id_cus_brn').select();
	}
});

$(document).on('keypress', '#id_cus_brn', function(e) {
	if(e.which == 13) {      
		e.preventDefault();

		var obj = $(this);
      	var id_cus_brn = obj.val();
      	while (id_cus_brn.length < 3) 
        	id_cus_brn = "0" + id_cus_brn;
      	$('#id_cus_brn').val(id_cus_brn);
		$('#id_cus_vol').focus();
		$('#id_cus_vol').select();
	}
});

$(document).on('keypress', '#id_cus_vol', function(e) {
	if(e.which == 13) {      
		e.preventDefault();

		// TODO: field validation
		cus_id = $('#id_cus_id').val();
		cus_brn = $('#id_cus_brn').val();
		cus_vol = $('#id_cus_vol').val();
		
		if(cus_id=="") {
			alert("Please entet Customer ID.");
			$('#id_cus_id').focus();				
			return false;
		}

		if(cus_brn=="") {
			alert("Please entet Customer Branch.");
			$('#id_cus_brn').focus();
			return false;			
		}

		if(cus_vol=="") {
			alert("Please entet Customer Volume.");
			$('#id_cus_vol').focus();
			return false;
		}

		var obj = $(this);
      	var id_cus_vol = obj.val();
      	while (id_cus_vol.length < 3) 
        	id_cus_vol = "0" + id_cus_vol;
      	$('#id_cus_vol').val(id_cus_vol);


		// Get customer data (ajax)      	
		$.ajax({
        	url : "/monitoring/ajax/get_customer/",
        	type : "POST",
        	data : {          
          	csrfmiddlewaretoken: '{{ csrf_token }}',
          	cus_id: cus_id,
          	cus_brn: cus_brn,
          	cus_vol: cus_vol,
        	},
        	success : function(data) {				
				
				if(data.is_existed) {
					$("#contract_service_list_form :input").attr("disabled", false);
					
					$("#security_guard_list_form :input").attr("disabled", false);
					$("#id_emp_id").attr("disabled", true);
					$("#emp_id_lookup_button").attr("disabled", true);

					$("#id_duration_from").attr("disabled", true);
					$("#chkDurationToDisable").attr("disabled", true);
					$("#id_duration_to").attr("disabled", true);
					$("#chkDurationFromDisable").attr("disabled", true);

					$("#id_service_active").attr("disabled", true);
					$("#id_relief").attr("disabled", true);

					$("#save_security_guard_button").attr("disabled", true);
					$("#cancel_security_guard_button").attr("disabled", true);

					$("#schedule_maintenance_form :input").attr("disabled", true);					
					$("#cancelCustomerServicePersonButton").attr("disabled", false);

					result_title = "";
					//result_title = "<h4 class='m-0 text-dark'>" + data.cus_site_name_th + "<small>&nbsp;&nbsp;<button type='button' class='btn btn-tool' data-card-widget='collapse'><i class='fas fa-angle-down text-dark'></i></button></small></h4>";
					result_title = "<h4 class='m-0 text-dark'><b>" + data.cus_site_name_th + "<small>&nbsp;&nbsp;<button type='button' class='btn btn-tool' data-card-widget='collapse'></button></small></b></h4>";

					
					$("#customer_name_title").html(result_title);
					//$("#customer_name_title").html("<span class='badge badge-success'>&nbsp;&nbsp;" + result_title + "&nbsp;&nbsp;</span>");

					$("#id_cnt_doc_no").val(data.cnt_doc_no);

					var cnt_active = data.cnt_active;
					if(cnt_active==1) {
						$('#id_cnt_active').val(1);
						$('#id_cnt_active').prop("checked", true);
					} else {
						$('#id_cnt_active').val(0);
						$('#id_cnt_active').prop("checked", false);
					}

					$("#id_cnt_sign_frm").val(data.cnt_sign_frm);
					$("#id_cnt_sign_to").val(data.cnt_sign_to);					
					$("#id_cnt_eff_frm").val(data.cnt_eff_frm);
					$("#id_cnt_eff_to").val(data.cnt_eff_to);
					$("#id_cnt_wage_name_en").val(data.cnt_wage_name_en);
					$("#id_cnt_apr_by_name_en").val(data.cnt_apr_by_name_en);

					$("#id_cus_main_cus_name_th").val(data.cus_main_cus_name_th + " (" + data.cus_main_cus_name_en + ")");
					$("#id_cus_main_cus_tel").val(data.cus_main_cus_tel);
					$("#id_cus_site_name_th").val(data.cus_site_name_th + " (" + data.cus_site_name_en + " )");
					$("#id_cus_site_add_th").val(data.cus_site_add_th + " " + data.cus_site_district_th + " " + data.cus_site_city_th + " " + data.cus_site_zip + " " + data.cus_site_country_th);
					$("#id_cus_site_tel").val(data.cus_site_tel);
					$("#id_cus_site_contact_name_th").val(data.cus_site_contact_name_th + " (" + data.cus_site_contact_position_th + ")");

		    		//$("#id_cus_main_cus_name_th").css("background-color", "green");
		    		//$("#id_cus_main_cus_name_th").animate({color:'white'}, 1000);					

					// Contract Service List
					result = "";
					result += "<font size='2'>";
					//result += "<table id='contractServiceListTable' class='table table-bordered table-sm'>";
					result += "<table id='contractServiceListTable' class='table table-fixed table-sm table-condensed'>";
					result += "  <thead>";
					result += "    <tr>";
					result += "      <th scope='col' name='service_id' class='d-none'>Service ID</th>";	
					result += "      <th scope='col'>No</th>";
					result += "      <th scope='col'>Rank</th>";
					result += "      <th scope='col'>Shift</th>";
					result += "      <th scope='col' class='text-center'>QTY</th>";
					result += "      <th scope='col'>Eff From</th>";
					result += "      <th scope='col'>Eff To</th>";
					result += "      <th scope='col' class='text-center'>MON</th>";
					result += "      <th scope='col' class='text-center'>TUE</th>";
					result += "      <th scope='col' class='text-center'>WED</th>";
					result += "      <th scope='col' class='text-center'>THU</th>";
					result += "      <th scope='col' class='text-center'>FRI</th>";
					result += "      <th scope='col' class='text-center'>SAT</th>";
					result += "      <th scope='col' class='text-center'>SUN</th>";
					result += "      <th scope='col' class='text-center'>PUB</th>";
					result += "      <th scope='col' class='text-center'>Status</th>";
					result += "      <th scope='col'>Remark</th>";
					result += "      <th scope='col'>Update Date</th>";
					result += "      <th scope='col'>Update By</th>";
					result += "    </tr>";
					result += "  </thead>";
					result += "  <tbody>";

					if(data.cus_service_list.length>0) {
						count = 1;
						for(i=0; i<data.cus_service_list.length; i++) {
							result += "    <tr class='clickableRow' data-serviceid='" + data.cus_service_list[i]["srv_id"] + "'>";
							result += "      <td scope='row' class='d-none'>" + data.cus_service_list[i]["srv_id"] + "</td>";
							result += "      <td scope='row'>" + count + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_rank"] + "</td>";							
							//result += "      <td>" + data.cus_service_list[i]["srv_shif_id"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_shift_name"] + "</td>";							
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_qty"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_eff_frm"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_eff_to"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_mon"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_tue"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_wed"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_thu"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_fri"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_sat"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_sun"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_pub"] + "</td>";

							if(data.cus_service_list[i]["srv_active"]=='Y')
								result += "      <td class='text-center text-success'><span class='badge badge-success'>active</span></td>";
							else
								result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_active"] + "</td>";

							result += "      <td class='text-danger'>" + data.cus_service_list[i]["srv_rem"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["upd_by"] + "</td>";							
							result += "    </tr>";						
							count++;
						}
					} else {
						result += "<tr><td colspan='18' align='center' class='text-danger'><br><font size='3'><i class='fas fa-xs fa-exclamation'></i>&nbsp;Sorry, there is no service available.</font><br><br></td></tr>";

						$("#add_security_guard_button").attr("disabled", true);
					}

					result += "  </tbody>";
					result += "</table>";
					result += "</font>";

					$(".card-contract-service-list .card-body").html(result);
					$("#contract_service_list_amount").html("Total <b>" + data.cus_service_list.length + "</b>");




					// Security Guard List
					result = "";

					if(data.sch_plan_list.length>0) {
						count = 1;
						for(i=0; i<data.sch_plan_list.length; i++) {
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";							
							
							//result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b></a></b></td>";
							result += "      <td><b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
  
							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_mon"] == "99") {
								//result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
								result += "      <td class='text-center text-danger'>OFF</td>";
							}
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_tue"] == "99") {
								//result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";
								result += "      <td class='text-center text-danger'>OFF</td>";
							}
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_wed"] == "99") {								
								//result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";
								result += "      <td class='text-center text-danger'>OFF</td>";
							}
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_thu"] == "99") {								
								//result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";
								result += "      <td class='text-center text-danger'>OFF</td>";
							}
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_fri"] == "99") {
								//result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
								result += "      <td class='text-center text-danger'>OFF</td>";
							}								
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_sat"] == "99") {
								//result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
								result += "      <td class='text-center text-danger'>OFF</td>";
							}
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_sun"] == "99") {
								//result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";
								result += "      <td class='text-center text-danger'>OFF</td>";
							}								
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";

							if(data.sch_plan_list[i]["sch_active"]==1) {
								result += "      <td class='text-center text-success'><span class='badge badge-success'>active</span></td>";
							}
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1)
								result += "      <td class='text-center text-success'>Yes</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["upd_flag"] + "</td>";
							
							//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "','" + data.sch_plan_list[i]["srv_id"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        //result += "		     &nbsp;";
					        //result += "		     <button type='button' id='btn_delete_customer' class='btn btn-danger btn-xs js-delete-customer' data-url='' >";
					        //result += "		       <i class='fas fa-trash fa-xs'></i>";
					        //result += "		     </button>";
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";						
							count++;
						}
					} else {
						result += "<tr><td colspan='18' align='center' class='text-danger'><br><font size='3'>There is no data available.</font><br><br></td></tr>";
					}

					$("#security_guard_list_amount").html("Total <b>" + data.sch_plan_list.length + "</b>");

					refresh_table(result);

				} else {					
					$("#contract_service_list_form :input").attr("disabled", true);
					$("#security_guard_list_form :input").attr("disabled", true);
				    $(document).Toasts('create', {
				      class: 'bg-danger', 
				      title: "{% trans 'Error message' %}",
				      subtitle: '',
				      autohide: true,
				      delay: 2000,
				      body: "Schedule Number is not found. Please try again.",
				      autoDismiss: true,
				      close: true,
				      autoremove: true,
				    });
				    $("#id_cus_id").focus();
				}

				//$("#customer_name_title").html(result_title);
        	},
        	error: function(data){
          		alert("error");
        	}
      	});
      			
	}
});

function refresh_table(result) {
	table.destroy();

	$('#id_security_guard_list tbody').empty().append(result);        

	table = $('#id_security_guard_list').DataTable({
	  "paging": false,
	  "pageLength": 15,
	  "scrollCollapse": true,
	  "lengthChange": false,
	  "searching": true,
	  "ordering": true,
	  "info": false,
	  "autoWidth": true,
	  "dom": '<"top"i>Brtip<"bottom"><"clear">',
	  "search": "_INPUT_",
	  "searchPlaceholder": "Search",  
	  "language": {
	    search: '<i class="fa fa-filter" aria-hidden="true"></i>',
	    searchPlaceholder: 'Filter data'
	  },
	  "columnDefs": [
	  	{"targets": 0, "orderable": true},
	  	{"targets": 1, "orderable": true},
	  	{"targets": 2, "orderable": true},
	  	{"targets": 3, "orderable": false},
	  	{"targets": 4, "orderable": false},
	  	{"targets": 5, "orderable": false},
	  	{"targets": 6, "orderable": false},
	  	{"targets": 7, "orderable": false},
	  	{"targets": 8, "orderable": false},
	  	{"targets": 9, "orderable": false},
	  	{"targets": 10, "orderable": false},
	  	{"targets": 11, "orderable": false},
	  	{"targets": 12, "orderable": false},
	  	{"targets": 13, "orderable": false},
	  	{"targets": 14, "orderable": false},
	  	{"targets": 15, "orderable": false},
	  	{"targets": 16, "orderable": false},
	  	{"targets": 17, "orderable": false},
	  	{"targets": 18, "orderable": false},
	  ],	  
	  buttons: [
	    {
	        extend: 'print',
	        title: '',
	        exportOptions: {
	          columns: [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
	        }
	    },
	    {
	        extend: 'excelHtml5',        
	        title: '',
	        exportOptions: {
	          columns: [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
	        }
	    },
	  ]	  
	});

	table.buttons('.buttons-print').nodes().css("display", "none");
	table.buttons('.buttons-excel').nodes().css("display", "none");

	$('#employee_search_button').on( 'keyup click', function () {
	table.search($('#employee_search_text').val()).draw();
	});

	$('#employee_search_text').on( 'keyup click', function () {
	table.search($('#employee_search_text').val()).draw();
	});  		

	$('#employee_search_clear_button').on( 'click', function () {
		$('#employee_search_text').val("");
		table.search($('#employee_search_text').val()).draw();
	});
}

function update_sch_plan(sch_no, srv_id) {
	cus_id = $('#id_cus_id').val();
	cus_brn = $('#id_cus_brn').val();
	cus_vol = $('#id_cus_vol').val();	
	sch_no = sch_no;

	$("#id_selected_service_id").val(srv_id);

	if(cus_id=="") {
		alert("Please entet Customer ID.");
		$('#id_cus_id').focus();				
		return false;
	}

	if(cus_brn=="") {
		alert("Please entet Customer Branch.");
		$('#id_cus_brn').focus();
		return false;			
	}

	if(cus_vol=="") {
		alert("Please entet Customer Volume.");
		$('#id_cus_vol').focus();
		return false;
	}

	if(sch_no=="") {
		return false;		
	} else {
		$("#id_selected_sch_no").val(sch_no);
	}
	
	showLoading();

	$.ajax({
    	url : "/monitoring/ajax/get_customer_schdule_plan/",
    	type : "POST",
    	data : {          
      	csrfmiddlewaretoken: '{{ csrf_token }}',
      	cus_id: cus_id,
      	cus_brn: cus_brn,
      	cus_vol: cus_vol,
      	sch_no: sch_no,
    	},
    	success: function(data) {
			var todayDate = new Date();
			var dd = String(todayDate.getDate()).padStart(2, '0');
			var mm = String(todayDate.getMonth() + 1).padStart(2, '0');
			var yyyy = todayDate.getFullYear();	
			todayDate = dd + '/' + mm + '/' + yyyy;
			var todayDate = moment(todayDate, "DD/MM/YYYY");
			var unlimitedDate = moment("31/12/2999", "DD/MM/YYYY");
			var contractServiceFromDate = moment(data.sch_date_frm, "DD/MM/YYYY");
			var contractServiceToDate = moment(data.sch_date_to, "DD/MM/YYYY");
			var employeePhoto = data.employee_photo;
			employeePhoto = "<img src='data:image/png;base64," + employeePhoto + "' style='width:100px;'/>"			
			

    		$("#id_selected_sch_no").val(data.sch_no); 		
    		$("#id_emp_id").val(data.emp_id);
    		$("#employeePhoto").html(employeePhoto);
			$("#id_emp_id").attr("disabled", true);
			$("#emp_id_lookup_button").attr("disabled", true);
    		
    		$("#id_emp_name_th").val(data.emp_fname_th.trim() + " " + data.emp_lname_th.trim());    		
    		$(window).scrollTop($('#security_guard_list_title').offset().top);

    		$("#id_emp_name_th").css("background-color", 'green');
    		$("#id_emp_name_th").animate({color:'white'}, 1000);

    		$("#id_sch_rank").val(data.sch_rank);
    		$("#id_sch_dept").val(data.emp_type);
    		

    		// Check Duration From's condition
    		//$("#id_duration_from").val(data.sch_date_frm);
    		$('#id_duration_from').datepicker('setDate', data.sch_date_frm);
    		$("#chkDurationFromDisable").prop("checked", true);
    		if(contractServiceFromDate <= todayDate) {
	    		$("#chkDurationFromDisable").attr("disabled", true);
	    		$("#id_duration_from").attr("disabled", true);
    		} else {
	    		$("#chkDurationFromDisable").attr("disabled", false);
	    		$("#id_duration_from").attr("disabled", false);
    		}


    		// Check Duration To condition
    		if(contractServiceToDate<unlimitedDate) {
	    		$('#id_duration_to').attr("disabled", false);
				$("#chkDurationToDisable").attr("disabled", false);

				if(contractServiceToDate==unlimitedDate)					
					$("#chkDurationToDisable").prop("checked", false);
				else
					$("#chkDurationToDisable").prop("checked", true);
    		} else {
	    		$('#id_duration_to').attr("disabled", true);
				$("#chkDurationToDisable").prop("checked", false);
				$("#chkDurationToDisable").attr("disabled", false);
    		}

    		if(data.sch_active==1) {
    			$("#id_service_active").prop("checked", true);
    		}
    		else {
    			$("#id_service_active").prop("checked", false);
    		}

    		if(data.relief==1) {
    			$("#id_relief").prop("checked", true);
    		}
    		else {
    			$("#id_relief").prop("checked", false);
    		}

    		$("#id_emp_join_date").val(data.emp_join_date);
    		$("#id_emp_term_date").val(data.emp_term_date);

    		$("#id_emp_status").val(data.emp_status_id + " | " + data.emp_status);
    		if(data.emp_status_id!="2")
    			$('#id_emp_status').css({'background-color':'#dc3545', 'color':'white'});
    		else
    			$('#id_emp_status').css({'background-color':'', 'color':'#495057'});

    		$("#id_mon_shift").val(data.sch_shf_mon);
    		$("#id_tue_shift").val(data.sch_shf_tue);
    		$("#id_wed_shift").val(data.sch_shf_wed);
    		$("#id_thu_shift").val(data.sch_shf_thu);
    		$("#id_fri_shift").val(data.sch_shf_fri);
    		$("#id_sat_shift").val(data.sch_shf_sat);
    		$("#id_sun_shift").val(data.sch_shf_sun);
			
    		$("#save_security_guard_button").attr("disabled", false);
    		$("#cancel_security_guard_button").attr("disabled", false); 
						
			$("#id_service_active").attr("disabled", false);
			$("#id_relief").attr("disabled", false);

			$("#id_mon_shift").attr("disabled", false);
			$("#id_tue_shift").attr("disabled", false);
			$("#id_wed_shift").attr("disabled", false);
			$("#id_thu_shift").attr("disabled", false);
			$("#id_fri_shift").attr("disabled", false);
			$("#id_sat_shift").attr("disabled", false);
			$("#id_sun_shift").attr("disabled", false);
			$.LoadingOverlay("hide");
    	},
    	error: function(data) {
		    $(document).Toasts('create', {
		      class: 'bg-danger', 
		      title: "{% trans 'Error message' %}",
		      subtitle: '',
		      autohide: true,
		      delay: 2000,
		      body: "There is an error. Please contact IT.",
		      autoDismiss: true,
		      close: true,
		      autoremove: true,
		    });
		    $.LoadingOverlay("hide");  		
    	},
    });	
}

function select_employee(emp_id, emp_fname_th, emp_lname_th, emp_join_date, emp_term_date, emp_rank, emp_type, emp_status) {

	showLoading();
	// Get employee photo
	$.ajax({
    	url: "/monitoring/ajax/get_employee_photo",        	
		type: 'get',          
      	dataType: 'json',
      	async: true,
      	data : { 
        	emp_id: emp_id,
      	},          
		success: function (data) {
			var result = "";
			$("#employeePhoto").html("<img src='data:image/png;base64," + data.employee_photo + "' style='width:90px;'/>");			
			$.LoadingOverlay("hide");
		},
	});	

	$("#security_guard_list_form").trigger("reset");
	$("#id_emp_id").val(emp_id);	
	$("#id_emp_name_th").val(emp_fname_th + "   " + emp_lname_th);
	$("#id_emp_join_date").val(emp_join_date);
	$("#id_emp_term_date").val(emp_term_date);
	$("#id_sch_rank").val(emp_rank);
	$("#id_sch_dept").val(emp_type);
	$("#id_emp_status").val(emp_status);

	$("#id_emp_name_th").css("background-color", 'green');
	$("#id_emp_name_th").animate({color:'white'}, 1000);
	$("#select_employee_modal").modal("hide");
			
	//$("#id_duration_from").focus();
};


function get_next_page(page_no) {

	var search_key = $("#id_employee_search_text").val();
	var search_option = $("#id_employee_option").val();	

	var result = "";	
	var page = page_no;

	$.ajax({
    	url: "/monitoring/ajax/get_employee_list",        	
		type: 'get',          
      	dataType: 'json',
      	data : { 
        	page: page_no,
        	search_key: search_key,
        	search_option: search_option,
      	},          
		success: function (data) {
			var result = "";
			var count = data.results.length;

			result += "<div class='row col-12'>";
			result += "<div class='col-8 offset-3 pb-2'>";
			result += "<form id='search_employee_modal_form' class='form-inline col-12' accept-charset='UTF-8'>";
			result += "  <div class='form-group mx-sm-3 mb-2'>";
			result += "  <select name='employee_option' class='form-control form-control-sm' required id='id_employee_option'>";

			if(search_option==1) {
				result += "    <option value='1' selected>Employee ID</option>";
				result += "    <option value='2'>Employee Name (TH)</option>";
				result += "    <option value='3'>Employee Name (EN)</option>";
			} else if(search_option==2) {
				result += "    <option value='1'>Employee ID</option>";
				result += "    <option value='2' selected>Employee Name (TH)</option>";
				result += "    <option value='3'>Employee Name (EN)</option>";
			} else {
				result += "    <option value='1'>Employee ID</option>";
				result += "    <option value='2'>Employee Name (TH)</option>";
				result += "    <option value='3' selected>Employee Name (EN)</option>";
			}

			result += "  </select>&nbsp;&nbsp;&nbsp;&nbsp;";
			result += "    <label for='id_employee_search_text' class='sr-only'>Search</label>";            
			result += "    <input type='text' class='form-control form-control-sm' id='id_employee_search_text' name='employee_search_text' value='" + search_key + "'>";
			result += "  </div>";
			result += "<a href='javascript:search_employee_modal()' type='button' class='btn btn-primary btn-sm mb-2'>Search</a>";            
			result += "</form>";
			result += "</div>";


			result += "<div class='col-12 pl-3'>";
			
			result += "<font size='2'>";

			result += "<table class='table table-sm table-hover'>";
			
			result += " <thead>";
			result += "   <tr>";
			result += "     <th scope='col'>{% trans 'Employee ID' %}</th>";
			result += "     <th scope='col'>{% trans 'First Name (TH)' %}</th>";
			result += "     <th scope='col'>{% trans 'Last Name (TH)' %}</th>";
			result += "     <th scope='col'>&nbsp;</th>";
			result += "   </tr>";
			result += " </thead>";
			result += "<tbody>";
			result += "</div>";

			result += "<div>";

			for(var i=0; i<count; i++) {              
			  var emp_id = data.results[i]["emp_id"];
			  var emp_fname_th = data.results[i]["emp_fname_th"].trim();
			  var emp_lname_th = data.results[i]["emp_lname_th"].trim();
			  var emp_fname_en = data.results[i]["emp_fname_en"].trim();
			  var emp_lname_en = data.results[i]["emp_lname_en"].trim();
			  var emp_join_date = data.results[i]["emp_join_date"]
			  var emp_term_date = data.results[i]["emp_term_date"]
			  var emp_rank = data.results[i]["emp_rank"]
			  var emp_type = data.results[i]["emp_type"]
			  var emp_status = data.results[i]["emp_status"]

			  result += "<tr>";
			  result += "<td>" + emp_id + "</td>";
			  result += "<td>" + emp_fname_th + "</td>";
			  result += "<td>" + emp_lname_th + "</td>";
			  
			  result += "<td><a href='javascript:select_employee(" + emp_id + ",\"" + emp_fname_th + "\",\"" + emp_lname_th + "\",\"" + emp_join_date + "\",\"" + emp_term_date + "\",\"" + emp_rank + "\",\"" + emp_type + "\",\"" + emp_status + "\");' type='button' class='btn btn-outline-primary btn-sm'>Select</a></td>";
			  result += "</tr>";              
			}
			result += " </tbody>";
			result += "</table>";
			result += "</font>";

			if(data.is_paginated) {
			  	result += "<div class='text-center'>";
			  	result += "  <span>";

				if(data.current_page_number > 1) {
					result += "<a href='javascript:get_next_page(" + data.previous_page +");'>" + "<i class='fas fa-arrow-circle-left'></i></a>&nbsp;&nbsp;&nbsp;&nbsp;";
				  	result += data.current_page_number + " of " + data.current_page_paginator_num_pages;
				  	result += "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:get_next_page(" + data.next_page + ");'>" + "<i class='fas fa-arrow-circle-right'></i></a>";
				}
				else {
				  	result += data.current_page_number + " / " + data.current_page_paginator_num_pages;
			  		result += "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:get_next_page(" + data.next_page + ");'>" + "<i class='fas fa-arrow-circle-right'></i></a>";		
				}
				
			  	result += "    </span>";
			  	result += "</div>";
			}

			$("#select_employee_modal .modal-body").html(result);			
        },          	
      	error: function (data) {
      		result += "Error";
      	},
    });
}


$(document).ready(function(){

	$('#get_employee_lookup').on('click', function (e) {
	  var obj = $(this);
	  current_emp_id = $('#id_emp_id').val();
	  //alert(current_district_id);

	  /*
	  $.ajax({
	      url: obj.attr("data-url"), // get_district_list
	      type: 'get',          
	      dataType: 'json',
	      data : {          
	        current_district_id : current_district_id,
	      },          
	      beforeSend: function () {
	        $("#districtmodal").modal("show");
	      },
	      success: function (data) {
	        var result = "";
	        var count = data.results.length;
	        var dist_id = data.results[0]["dist_id"];
	        var dist_th = data.results[0]["dist_th"];

	        result += "<div class='row col-12'>";
	        result += "<div class='col-8 offset-3 pb-2'>";
	        result += "<form id='search_employee_modal_form' class='form-inline col-12' accept-charset='UTF-8'>";
	        result += "  <div class='form-group mx-sm-3 mb-2'>";
	        result += "  <select name='cus_main_cus_district_option' class='form-control form-control-sm' required id='id_cus_main_cus_district_option'>";
	        result += "    <option value='1'>District ID</option>";
	        result += "    <option value='2' selected>District</option>";
	        result += "    <option value='3'>City</option>";
	        result += "  </select>&nbsp;&nbsp;&nbsp;&nbsp;";
	        result += "    <label for='id_cus_main_search_district' class='sr-only'>Search</label>";            
	        result += "    <input type='text' class='form-control form-control-sm' id='id_cus_main_cus_district_search_text' name='cus_main_cus_district_search_text' placeholder=''>";
	        result += "  </div>";
	        result += "<a href='javascript:search_employee_modal()' type='button' class='btn btn-primary btn-sm mb-2'>Search</a>";            
	        result += "</form>";
	        result += "</div>";

	        result += "<div class='row col-12'>";
	        result += "<table class='table table-hover table-sm'>";
	        result += " <thead>";
	        result += "   <tr>";
	        result += "     <th scope='col'>{% trans 'District ID' %}</th>";
	        result += "     <th scope='col'>{% trans 'District' %}</th>";
	        result += "     <th scope='col'>{% trans 'City' %}</th>";
	        result += "     <th scope='col'>&nbsp;</th>";
	        result += "   </tr>";
	        result += " </thead>";
	        result += "<tbody>";
	        result += "</div>";
	        result += "<div>";

	        for(var i=0; i<count; i++) {              
	          var dist_id = data.results[i]["dist_id"];
	          var dist_name_th = data.results[i]["dist_th"];
	          var dist_name_en = data.results[i]["dist_en"];
	          var city_name_th = data.results[i]["city_th"];
	          var city_name_en = data.results[i]["city_en"];
	          var country_name_th = data.results[i]["country_name_th"];
	          var country_name_en = data.results[i]["country_name_en"];

	          result += "<tr>";
	          result += "<td>" + dist_id + "</td>";        
	          result += "<td>" + dist_name_th + "</td>";
	          result += "<td>" + city_name_th + "</td>";
	          
	          result += "<td><a href='javascript:cus_main_select_district(" + dist_id + ",\"" + dist_name_th + "\",\"" + city_name_th + "\",\"" + dist_name_en + "\",\"" + city_name_en + "\",\"" + country_name_th + "\",\"" + country_name_en + "\");' type='button' class='btn btn-outline-primary btn-sm'>Select</a></td>";

	          result += "</tr>";              
	        }
	        result += " </tbody>";
	        result += "</table>";

	        if(data.is_paginated) {
	          result += "<div>";
	          result += "  <span>";
	          result += data.current_page_number + " / " + data.current_page_paginator_num_pages;
	          result += " <a href='javascript:get_cus_site_district_lookup(" + data.next_page + ");'>" + "<i class='fas fa-arrow-circle-right'></i></a>";
	          result += "    </span>";
	          result += "</div>";
	        }
	        
	        $("#districtmodal .modal-body").html(result);            
	      },
	      error: function(data){
	        $("#districtmodal .modal-body").html("{% trans 'There is no data.' %}");
	      }          
	  });
	  */

	});
});

function search_employee_modal() {
	var search_key = $("#id_employee_search_text").val();
	var search_option = $("#id_employee_option").val();	
	var page_no = 1;

	$.ajax({
    	url: "/monitoring/ajax/get_employee_list",
		type: 'get',          
      	dataType: 'json',
      	data : { 
        	search_option: search_option,
        	search_key: search_key,
        	page: page_no,
      	},          
      	beforeSend: function () {
      		//	
      	},
		success: function (data) {
			var result = "";
			var count = data.results.length;

			result += "<div class='row col-12'>";
			result += "<div class='col-8 offset-3 pb-2'>";
			result += "<form id='search_employee_modal_form' class='form-inline col-12' accept-charset='UTF-8'>";
			result += "  <div class='form-group mx-sm-3 mb-2'>";
			result += "  <select name='employee_option' class='form-control form-control-sm' required id='id_employee_option'>";
			
			if(search_option==1) {
				result += "    <option value='1' selected>Employee ID</option>";
				result += "    <option value='2'>Employee Name (TH)</option>";
				result += "    <option value='3'>Employee Name (EN)</option>";
			} else if(search_option==2) {
				result += "    <option value='1'>Employee ID</option>";
				result += "    <option value='2' selected>Employee Name (TH)</option>";
				result += "    <option value='3'>Employee Name (EN)</option>";
			} else {
				result += "    <option value='1'>Employee ID</option>";
				result += "    <option value='2'>Employee Name (TH)</option>";
				result += "    <option value='3' selected>Employee Name (EN)</option>";
			}

			result += "  </select>&nbsp;&nbsp;&nbsp;&nbsp;";
			result += "    <label for='id_employee_search_text' class='sr-only'>Search</label>";            
			result += "    <input type='text' class='form-control form-control-sm' id='id_employee_search_text' name='employee_search_text' value='" + search_key + "'>";
			result += "  </div>";
			result += "<a href='javascript:search_employee_modal()' type='button' class='btn btn-primary btn-sm mb-2'>Search</a>";            
			result += "</form>";
			result += "</div>";


			result += "<div class='col-12 pl-3'>";
			
			result += "<font size='2'>";

			result += "<table class='table table-sm table-hover'>";
			
			result += " <thead>";
			result += "   <tr>";
			result += "     <th scope='col'>{% trans 'Employee ID' %}</th>";
			result += "     <th scope='col'>{% trans 'First Name (TH)' %}</th>";
			result += "     <th scope='col'>{% trans 'Last Name (TH)' %}</th>";
			result += "     <th scope='col'>&nbsp;</th>";
			result += "   </tr>";
			result += " </thead>";
			result += "<tbody>";
			result += "</div>";

			result += "<div>";

			for(var i=0; i<count; i++) {              
			  var emp_id = data.results[i]["emp_id"];
			  var emp_fname_th = data.results[i]["emp_fname_th"].trim();
			  var emp_lname_th = data.results[i]["emp_lname_th"].trim();
			  var emp_fname_en = data.results[i]["emp_fname_en"].trim();
			  var emp_lname_en = data.results[i]["emp_lname_en"].trim();
			  var emp_join_date = data.results[i]["emp_join_date"]
			  var emp_term_date = data.results[i]["emp_term_date"]
			  var emp_rank = data.results[i]["emp_rank"]
			  var emp_type = data.results[i]["emp_type"]
			  var emp_status = data.results[i]["emp_status"]

			  result += "<tr>";
			  result += "<td>" + emp_id + "</td>";
			  result += "<td>" + emp_fname_th + "</td>";
			  result += "<td>" + emp_lname_th + "</td>";
			  
			  result += "<td><a href='javascript:select_employee(" + emp_id + ",\"" + emp_fname_th + "\",\"" + emp_lname_th + "\",\"" + emp_join_date + "\",\"" + emp_term_date + "\",\"" + emp_rank + "\",\"" + emp_type + "\",\"" + emp_status + "\");' type='button' class='btn btn-outline-primary btn-sm'>Select</a></td>";
			  result += "</tr>";              
			}
			result += " </tbody>";
			result += "</table>";
			result += "</font>";

			if(data.is_paginated) {
			  	result += "<div class='text-center'>";
			  	result += "  <span>";

				if(data.current_page_number > 1) {
					result += "<a href='javascript:get_next_page(" + data.previous_page + ");'>" + "<i class='fas fa-arrow-circle-left'></i></a>&nbsp;&nbsp;&nbsp;&nbsp;";
				  	result += data.current_page_number + " of " + data.current_page_paginator_num_pages;
				  	result += "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:get_next_page(" + data.next_page + ");'>" + "<i class='fas fa-arrow-circle-right'></i></a>";
				}
				else {
				  	result += data.current_page_number + " / " + data.current_page_paginator_num_pages;
			  		result += "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:get_next_page(" + data.next_page + ");'>" + "<i class='fas fa-arrow-circle-right'></i></a>";		
				}
				
			  	result += "    </span>";
			  	result += "</div>";
			}

			$("#select_employee_modal .modal-body").html(result);
        },          	
      	error: function (data) {
      		var result = "";

			result += "<div class='row col-12'>";
			result += "<div class='col-8 offset-3 pb-2'>";
			result += "<form id='search_employee_modal_form' class='form-inline col-12' accept-charset='UTF-8'>";
			result += "  <div class='form-group mx-sm-3 mb-2'>";
			result += "  <select name='employee_option' class='form-control form-control-sm' required id='id_employee_option'>";

			if(search_option==1) {
				result += "    <option value='1' selected>Employee ID</option>";
				result += "    <option value='2'>Employee Name (TH)</option>";
				result += "    <option value='3'>Employee Name (EN)</option>";
			} else if(search_option==2) {
				result += "    <option value='1'>Employee ID</option>";
				result += "    <option value='2' selected>Employee Name (TH)</option>";
				result += "    <option value='3'>Employee Name (EN)</option>";
			} else {
				result += "    <option value='1'>Employee ID</option>";
				result += "    <option value='2'>Employee Name (TH)</option>";
				result += "    <option value='3' selected>Employee Name (EN)</option>";
			}

			result += "  </select>&nbsp;&nbsp;&nbsp;&nbsp;";

			//result += "    <label for='id_employee_search_text' class='sr-only'>Search</label>";            
			result += "    <input type='text' class='form-control form-control-sm' id='id_employee_search_text' name='employee_search_text' value='" + search_key + "' >";
			result += "  </div>";
			result += "<a href='javascript:search_employee_modal()' type='button' class='btn btn-primary btn-sm mb-2'>Search</a>";            
			result += "</form>";

			result += "</div>";
			result += "<div class='col-12 pl-3'>";			
			result += "<font size='2'>";
			result += "<table class='table table-sm table-hover'>";
			result += " <thead>";
			result += "   <tr>";
			result += "     <th scope='col'>{% trans 'Employee ID' %}</th>";
			result += "     <th scope='col'>{% trans 'First Name (TH)' %}</th>";
			result += "     <th scope='col'>{% trans 'Last Name (TH)' %}</th>";
			result += "     <th scope='col'>&nbsp;</th>";
			result += "   </tr>";
			result += " </thead>";
			result += "<tbody>";
			result += "</div>";
			result += "<div>";			
		  	result += "<tr>";
		  	result += "<td colspan='4' class='text-center'><br><br><span class='text-danger'><b>Search not found.</b></span><br><br><br></td>";
			result += "</tr>";              
			result += " </tbody>";
			result += "</table>";
			result += "</font>";

      		$("#select_employee_modal .modal-body").html(result);
      		$("#id_employee_search_text").focus();
      	},
    });
}

function reset_security_guard_list_form() {
	$("#security_guard_list_form").trigger("reset");
	$("#id_selected_sch_no").val(0);
	$("#security_guard_list_form").trigger("reset");
	$("#save_security_guard_button").attr("disabled", true);
	$("#security_guard_list_form :input").prop("disabled", true);
	$("#add_security_guard_button").attr("disabled", false);
	$('input[type=radio][name=security_guard_list_status_option]').attr("disabled", false);
	$("#id_emp_name_th").css("background-color", '');
	$("#id_emp_name_th").animate({color:''}, 1000);
	$("#employeePhoto").html("<img src='/static/img/profile-128x128.png' width='90px;'' />");

	$('#id_emp_status').css({'background-color':'', 'color':'#495057'});
	$('#expand_security_guard_window_button').attr("disabled", false);

    $('#id_duration_from').datepicker({
        format: 'dd/mm/yyyy',
        altField: '#thealtdate',
        altFormat: 'dd/mm/yyyy',
        autoclose: true
    }).datepicker("setDate", new Date());

    $('#id_duration_to').datepicker({
        format: 'dd/mm/yyyy',
        altField: '#thealtdate',
        altFormat: 'dd/mm/yyyy',
        autoclose: true
    }).datepicker("setDate", new Date());

}

$(function(){
    $('#id_duration_from').datepicker({
        format: 'dd/mm/yyyy',
        altField: '#thealtdate',
        altFormat: 'dd/mm/yyyy',
        autoclose: true
    }).datepicker("setDate", new Date());

    $('#id_duration_to').datepicker({
        format: 'dd/mm/yyyy',
        altField: '#thealtdate',
        altFormat: 'dd/mm/yyyy',
        autoclose: true
    }).datepicker("setDate", new Date());

	/*
    $('#id_duration_from').datepicker({
        format: 'dd/mm/yyyy',
        altField: '#thealtdate',
        altFormat: 'dd/mm/yyyy'
    });

    $('#id_duration_to').datepicker({
        format: 'dd/mm/yyyy',
        altField: '#thealtdate',
        altFormat: 'dd/mm/yyyy'
    });
    */
});


function disableDurationFormDP(){
	durationFromStatus =  $("#chkDurationFromDisable").is(":checked");
	
	$("#id_duration_from").val($("#id_duration_from").val());
	
	if(durationFromStatus) {
		$("#id_duration_from").attr("disabled", false);
	} else {
		$("#id_duration_from").attr("disabled", true);
	}

	/*
	duration_from = $("#id_duration_from").val();
	if(duration_from!="") {
		$("#id_duration_from").attr("disabled", true).val(duration_from);
	} else {
		$("#id_duration_from").attr("disabled", false).val(duration_from);
	}
	*/
}

function disableDurationToDP() {
	durationToStatus =  $("#chkDurationToDisable").is(":checked");
	
	$("#id_duration_to").val($("#id_duration_to").val());
	
	if(durationToStatus) {
		$("#id_duration_to").attr("disabled", false);
	} else {
		$("#id_duration_to").attr("disabled", true);
	}
}

$(document).on('click', '#contractServiceListTable tbody tr', function(row, $el, field) {
	$(this).addClass('highlight').siblings().removeClass('highlight');

	var service_id = $(this).find('td:eq(0)').text();	
	var srv_eff_from = $(this).find('td:eq(5)').text();
	var srv_eff_to = $(this).find('td:eq(6)').text();

	$('#id_selected_service_id').val(service_id);

	$('#id_duration_from').datepicker('setDate', srv_eff_from);
	$("#chkDurationFromDisable").prop("checked", true);
	
	$('#id_duration_to').datepicker('setDate', srv_eff_to);
	$("#chkDurationToDisable").prop("checked", true);	
});

function showLoading() {
	$.LoadingOverlaySetup({
	    background      : "rgba(0, 0, 0, 0.5)",
	    image           : "/static/img/logo-small.png",
	    imageAnimation  : "1.5s fadein",
	    imageColor      : "#ffcc00"
	});
	$.LoadingOverlay("show");	
}

</script>
{% endblock %}

