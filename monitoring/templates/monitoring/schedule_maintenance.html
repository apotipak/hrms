{% extends "page_generic.html" %}
{% load i18n %}
{% load static %}
{% load widget_tweaks %}
{% block title %}{{ page_title}} - Schedule Maintenance{% endblock %}
{% load static %}

{% block content %}
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
	
	<div class="content-header">
		<div class="col-6 offset-2">
		<form id="schedule_maintenance_form" method="POST" class="form-inline">
		{% csrf_token %}

		  <div class="form-row">
		    <div class="form-group">
		      <label for="inputPassword6">Schedule No</label>&nbsp;&nbsp;
		      {% render_field form.cus_id %}&nbsp;
		      {% render_field form.cus_brn %}&nbsp;
		      {% render_field form.cus_vol %}&nbsp;&nbsp;
		      <button id="cancelCustomerServicePersonButton" type="button" class="btn btn-md btn-warning pull-right">Cancel</button>
		    </div>
		  </div>
		</form>
		</div>
	</div>

    <!-- Main content -->
    <section class="content">
		
      	<!-- 1st Block -->
      	<div class="card">

	    	<div class="card-header">

		        <h1 class="card-title pt-2">
		          <span id="customer_name_title">            
		            <h3 class="m-0 text-dark">Customer Information<small>&nbsp;&nbsp;<button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-angle-down text-primary"></i></button></small></h3>            
		          </span>
		        </h1>

				<form id="contract_service_list_form" method="POST">
	      		{% csrf_token %}

		        	<div class="card-tools float-right">
		        	<!--
			          <button class="btn btn-outline-info btn-md dropdown-toggle" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			            <i class="fas fa-print fa-sm"></i>&nbsp;&nbsp;Print
			          </button>
			          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">			            
			            <a class="dropdown-item" href="#" onclick="print_contract()"><i class="fa fa-eye text-secondary" aria-hidden="true"></i>&nbsp;&nbsp;Display on screen</a>	
			            <input type="hidden" id="id_cnt_id_temp" name="cnt_id_temp" value="">
			          </div>
			      	
		          		<button id="cancelCustomerServicePersonButton" type="button" class="btn btn-md btn-default pull-right">Cancel</button>
		          	-->
		          		<!--
		          		<button id="saveCustomerServicePersonButton" class="btn btn-md btn-primary"><i class="fas fa-save fa-sm"></i>&nbsp;&nbsp;{% trans 'Save' %}</button>
		          		-->
		        	</div>

		    </div>
	       


	        <div class="card-body col-12">

				<!-- Contract Active Status -->
				<div class="row float-right">
                    <div class="btn-group">
                      <label class="switch">                                 
                        <input type="checkbox" id="id_cnt_active" name="cnt_active" disabled="">
                        <div class="slider"></div>
                      </label>  
                    </div>

		            <div>&nbsp;</div>
				</div>

				<div class="clearfix">&nbsp;</div>

				<div class="row" style="white-space:nowrap;">

					<div class="col-8 float-left">

					  <div class="form-group row">
					    <label for="id_cus_main_cus_name" class="col-2 col-form-label" style="font-size:11pt">Customer</label>
					    <div class="col-6">
					      <input type="text" readonly class="form-control form-control-sm" style="font-size:9pt" id="id_cus_main_cus_name_th">
					    </div>
						<label for="id_cus_main_cus_name" class="col-1 col-form-label" style="font-size:11pt">Phone</label>
					    <div class="col-3">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cus_main_cus_tel" >
					    </div>
					  </div>

					  <!-- Site Name -->
					  <div class="form-group row">
					    <label for="id_site_cus_name" class="col-sm-2 col-form-label" style="font-size:11pt">Site Name</label>
					    <div class="col-sm-6">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cus_site_name_th">
					    </div>				   
						<label for="id_site_cus_name" class="col-sm-1 col-form-label" style="font-size:11pt">Phone</label>
					    <div class="col-sm-3">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cus_site_tel" >
					    </div>

					  </div>

					  <!-- Site Address -->
					  <div class="form-group row">
					    <label for="id_cus_site_add" class="col-sm-2 col-form-label" style="font-size:11pt">Address</label>
					    <div class="col-sm-10">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cus_site_add_th">
					    </div>
					  </div>

					  <!-- Cnt.Ref. Address -->
					  <div class="form-group row">
					    
					    <label for="id_cnt_doc_no" class="col-sm-2 col-form-label" style="font-size:11pt">Contract Ref.</label>
					    <div class="col-sm-2">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cnt_doc_no">
					    </div>

					    <label for="id_cnt_doc_no" class="col-sm-1 col-form-label" style="font-size:11pt">Contact</label>
					    <div class="col-sm-7">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cus_site_contact_name_th">
					    </div>
					  </div>

					</div>


					<div class="col-4 float-right">

					  <div class="form-group row">
					    <label for="id_cnt_wage_name_en" class="col-4 col-form-label" style="font-size:11pt">Wage Rate</label>
					    <div class="col-sm-8">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cnt_wage_name_en" >
					    </div>
					  </div>

					  <div class="form-group row">
					  	<label for="id_cnt_apr_by_name_en" class="col-4 col-form-label" style="font-size:11pt">Authorized by</label>
					    <div class="col-sm-8">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cnt_apr_by_name_en" >
					    </div>		    
					  </div>

					  <div class="form-group row">
					  	<label for="id_cus_main_cus_name" class="col-4 col-form-label" style="font-size:11pt">Contract Term</label>
					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cnt_sign_frm" >
					    </div>
					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cnt_sign_to" >
					    </div>
					  </div>

					  <div class="form-group row">
					  	<label for="id_cus_main_cus_name" class="col-4 col-form-label" style="font-size:11pt">Effective Term</label>
					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cnt_eff_frm" >
					    </div>
					    <div class="col-sm-4">
					      <input type="text" readonly class="form-control" style="font-size:9pt" id="id_cnt_eff_to" >
					    </div>
					  </div>
					</div>
				</div>


			</div>


		   	</form>
      	</div>


      	<!-- Contract Service List -->      	
	    <div class="card card-contract-service-list" id="card-security-guard-list">
	      	<div class="card-header">                
	        	<div class="float-left"><h4 class="m-0 text-dark">Contract Service List&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;<small><small><span id="contract_service_list_amount"><b>Total 0</b></span></small></small></h4></div>
	        	<div class="float-left"><h4 class="m-0 text-dark"><span id="id_contract_number"></span></h4></div>
	        	<div class="card-tools">
	          		<div class="float-left">&nbsp;</div>
	        	</div>
	      	</div>
	      	<div class="card-body">&nbsp;</div>
	    </div>
  			

      	<!-- Security Guard List -->      	
	    <div class="card card-security-guard-list">

			<form id="security_guard_list_form" method="POST">
      		{% csrf_token %}

	      	<div class="card-header">                

	        	<div class="float-left">
	        		<h4 class="m-0 text-dark">Security Guard List&nbsp;&nbsp;
	        		<!--
	        		<small><small>
					<div class="form-check form-check-inline">
		              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_active" value="1" checked>
		              <label class="form-check-label" for="id_security_guard_list_option_active">Active</label>
		            </div>
		            <div class="form-check form-check-inline">
		              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_pending" value="2">
		              <label class="form-check-label" for="id_security_guard_list_option_pending">Pending</label>
		            </div>
		            <div class="form-check form-check-inline">
		              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_all" value="3">
		              <label class="form-check-label" for="id_security_guard_list_option_all">All</label>
		            </div>		            
	            	</small></small>
	            	-->
					<!--&nbsp;|&nbsp;&nbsp;	
	        		<small><small>	        		
	        		<span id="security_guard_list_amount"><b>Total 0</b></span></small></small>-->
	        		</h4>
	        	</div>

	        	<div class="card-tools">
		        	<div class="card-tools float-right">
		        		<button id="cancel_security_guard_button" type="button" class="btn btn-outline-secondary btn-sm">{% trans 'Cancel' %}</button>
		        		<button id="save_security_guard_button" type="button" class="btn btn-outline-primary btn-sm"><i class="fas fa-save fa-md"></i>&nbsp;&nbsp;{% trans 'Save' %}</button>
		        		&nbsp;&nbsp;|&nbsp;&nbsp;
		        		<button id="add_security_guard_button" type="button" class="btn btn-outline-success btn-sm"><i class="fas fa-plus fa-md"></i>&nbsp;&nbsp;{% trans 'Add' %}</button>&nbsp;		        				        	
		        	</div>
	        	</div>

	        	
	      	</div>

	      	<div class="card-body">

	      		<font size='2pt'>
				<div class="row" style="white-space:nowrap;">

					<div class="col-8 float-left">

					  <div class="form-group row">
					    <div class="col-3">
					    	<label class="form-check-label" for="id_emp_id"><b>Employee ID</b></label>
                            <div class="input-group">                            	
                              	<input type="text" id="id_emp_id" name="id_emp_id" class="form-control form-control-sm" value="" />
                              	<button id="id_emp_id_lookup" type="button" class="btn btn-outline-primary btn-sm" data-toggle="modal" data-url=""><i class="fas fa-search fa-sm"></i></button>

                              	<input type="hidden" id="id_selected_sch_no" name="id_selected_sch_no" value="">
                            </div>
					    </div>	
					    <div class="col-5">
					    	<label class="form-check-label" for="id_emp_name_th"><b>Name</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_emp_name_th" placeholder="" readonly />
					    </div>
					    <div class="col-2">
					    	<label class="form-check-label" for="id_emp_name_th"><b>Joined Date</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_emp_join_date" placeholder="" readonly />
					    </div>
					    <div class="col-2">
					    	<label class="form-check-label" for="id_emp_name_th"><b>Terminated Date</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_emp_term_date" readonly />
					    </div>					    
					  </div>




					  <div class="form-group row">
					    <div class="col-6">
					    	<label class="form-check-label" for="id_emp_name_th"><b>Employee Status</b></label>
					    	<input type="text" class="form-control form-control-sm" id="id_emp_status" placeholder="" readonly />
					    </div>

					    <div class="col-3">
					    	<label class="form-check-label" for="id_sch_rank"><b>Rank</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_sch_rank" placeholder="" readonly />
					    </div>

					    <div class="col-3">
					    	<label class="form-check-label" for="id_sch_rank"><b>Department</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_sch_dept" placeholder="" readonly />
					    </div>


					  </div>


					  <div class="form-group row">

					    <div class="col-3">
					    	<label class="form-check-label" for="id_sch_rank"><b>Service Duration</b></label>
					      	<input type="text" class="form-control form-control-sm" id="id_duration_from" placeholder="From" readonly />
					    </div>					    
					    <div class="col-3">
					    	<label class="form-check-label" for="id_sch_rank"></label>
					      	<input type="text" class="form-control form-control-sm" id="id_duration_to" placeholder="To" readonly />
					    </div>					    		    

					  	<div class="col-2">	   	
					  		<div><label class="form-label" for="id_sch_rank"><b>Service Status</b></label></div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="checkbox" id="id_service_active" value="1">
							  <label class="form-check-label" for="id_service_active"><b>Active</b></label>
							</div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="checkbox" id="id_relief">
							  <label class="form-check-label" for="id_relief"><b>Relief</b></label>
							</div>
						</div>
					  </div>
					</div>

					
					<div class="col-4 float-left">

						
						
						<div class="col-12 float-left">
							
							<div class="col-12">
								<div class="form-inline">
									<div class="text-center col-12"><b>SHIFT / WEEK</b>&nbsp;&nbsp;</div>									
		                        </div>								
							</div>

							<div class="text-left col-12">

							<div class="form-inline">
								<div class="text-left text-yellow col-2">&nbsp;</div>
								<div class="float-right text-right col-10 text-yellow">MON&nbsp;&nbsp;
	                          	<select name="id_mon_shift" class="form-control form-control-sm" required="" id="id_mon_shift" style="font-size:9pt">
		                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF </option> 
	                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
	                          	</select>
	                          	</div>
	                        </div>

							<div class="text-left form-inline">
								<div class="text-left text-pink col-2">&nbsp;</div>
								<div class="float-right text-right col-10 text-pink">TUE&nbsp;&nbsp;
	                          	<select name="id_tue_shift" class="form-control form-control-sm" required="" id="id_tue_shift" style="font-size:9pt">
		                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF </option> 
	                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
	                          	</select>
	                          	</div>
	                        </div>

							<div class="text-left form-inline">
								<div class="text-left text-green col-2">&nbsp;</div>
								<div class="float-right text-right col-10 text-green">WED&nbsp;&nbsp;
	                          	<select name="id_wed_shift" class="form-control form-control-sm" required="" id="id_wed_shift" style="font-size:9pt">
		                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF </option> 
	                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
	                          	</select>
	                          	</div>
	                        </div>

							<div class="text-left form-inline">
								<div class="text-left text-orange col-2">&nbsp;</div>
								<div class="float-right text-right col-10 text-orange">THU&nbsp;&nbsp;
	                          	<select name="id_thu_shift" class="form-control form-control-sm" required="" id="id_thu_shift" style="font-size:9pt">
		                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF </option> 
	                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
	                          	</select>
	                          	</div>
	                        </div>

							<div class="text-left form-inline">
								<div class="text-left text-blue col-2">&nbsp;</div>
								<div class="float-right text-right col-10 text-blue">FRI&nbsp;&nbsp;
	                          	<select name="id_fri_shift" class="form-control form-control-sm" required="" id="id_fri_shift" style="font-size:9pt">
		                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF </option> 
	                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
	                          	</select>
	                          	</div>
	                        </div>

							<div class="text-left form-inline">
								<div class="text-left text-blue col-2">&nbsp;</div>
								<div class="float-right text-right col-10 text-purple">SAT&nbsp;&nbsp;
	                          	<select name="id_sat_shift" class="form-control form-control-sm" required="" id="id_sat_shift" style="font-size:9pt">
		                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF </option> 
	                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
	                          	</select>
	                          	</div>
	                        </div>

							<div class="text-left form-inline">
								<div class="text-left text-blue col-2">&nbsp;</div>
								<div class="float-right text-right col-10 text-red">SUN&nbsp;&nbsp;
	                          	<select name="id_sun_shift" class="form-control form-control-sm" required="" id="id_sun_shift" style="font-size:9pt">
		                          	<option value="99">99&nbsp;&nbsp;&nbsp;# DAY OFF </option> 
	                              	<option value="999" selected>999&nbsp;&nbsp;&nbsp;# ANOTHER SITE&nbsp;&nbsp;&nbsp;&nbsp;</option>
	                          	</select>
	                          	</div>
	                        </div>
	                        </div>                        	                        
						</div>
												
					</div>
					




	      		</div> 

	      		<hr>
	      		<!-- Filter -->
	      		<div class="row">
	      			
	      			<div class="col-8 float-left pb-2">	      				

						<div class="form-check form-check-inline">
			              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_active" value="1" checked>
			              <label class="form-check-label" for="id_security_guard_list_option_active">Active</label>
			            </div>
			            <div class="form-check form-check-inline">
			              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_pending" value="2">
			              <label class="form-check-label" for="id_security_guard_list_option_pending">Pending</label>
			            </div>
			            <div class="form-check form-check-inline">
			              <input class="form-check-input" type="radio" name="security_guard_list_status_option" id="id_security_guard_list_option_all" value="3">
			              <label class="form-check-label" for="id_security_guard_list_option_all">All</label>

			              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<span id="security_guard_list_amount"><b>Total 0</b></span>
			            </div>			            

		        	</div>

		        	<div class="col-5 card-tools float-right text-right">
		        		<!--<button id="add_security_guard_button" type="button" class="btn btn-outline-success btn-sm" data-toggle="modal">{% trans 'Add' %}</button>-->
		        	</div>

	      		</div>


	      		</font>

				<div id="id_security_guard_list"></div>
	      	</div>

	      	</form>

	    </div>

		<div class="clearfix">&nbsp;</div>

    </section>
    <!-- /.content -->






	<!-- Add security guard modal -->
	<div class="modal fade" id="add_security_guard_modal" tabindex="-1" role="dialog">

	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      
	      <div class="modal-header">
	        <h5 class="modal-title" id="exampleModalLongTitle"><i class="fas fa-plus fa-sm text-secondary"></i>&nbsp;&nbsp;<strong>{% trans 'Add new guard' %}</strong></h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      
	      <div class="modal-body"></div>

	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary btn-md" data-dismiss="modal">{% trans 'Close' %}</button>
	        <button id="save_security_guard_button" onclick="save_new_service()" type="button" class="btn btn-primary btn-md"><i class="fas fa-save fa-sm"></i>&nbsp;&nbsp;{% trans 'Save' %}&nbsp;&nbsp;</button>
	      </div>
	    </div>
	  </div>
	</div>



	<!-- Select employee modal -->
	<div class="modal fade" id="select_employee_modal" tabindex="-1" role="dialog">

	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      
	      <div class="modal-header">
	        <h5 class="modal-title"><i class="fas fa-search fa-sm text-secondary"></i>&nbsp;&nbsp;{% trans 'Select an Employee' %}</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      
	      <div class="modal-body"></div>

	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary btn-md" data-dismiss="modal">{% trans 'Close' %}</button>	        
	      </div>
	    </div>
	  </div>
	</div>


  </div>
  <!-- /.content-wrapper -->

{% endblock %}


{% block javascript %}
<script>	
/*
document.addEventListener('contextmenu', function(e) {
  e.preventDefault();
});
*/
document.onkeydown = function(e) {
  if(event.keyCode == 123) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
     return false;
  }
}

$(document).ready(function(){
 	$('#add_security_guard_button').on('click', function (e) { 		
		$("#security_guard_list_form").trigger("reset");
		$("#save_security_guard_button").attr("disabled", false);
		$("#id_emp_id").focus();
    });

	$("#contract_service_list_form :input").attr("disabled", true);
	$("#security_guard_list_form :input").prop("disabled", true);	

	$("#id_cus_id").on('click', function(){
		$("#id_cus_id").select();
	});
	$("#id_cus_brn").on('click', function(){
		$("#id_cus_brn").select();
	});
	$("#id_cus_vol").on('click', function(){
		$("#id_cus_vol").select();
	});

	$('#id_cus_id').focus();


 	$("#cancel_security_guard_button").click( function() {
    	event.preventDefault();    	
    	$("#security_guard_list_form").trigger("reset");
    	$("#save_security_guard_button").attr("disabled", true);
    	$("#id_emp_id").focus();
    });

 	$("#id_emp_id_lookup").click( function(e) {
 		var result = "";
 		emp_id = $("#id_emp_id").val();
 		page = 1;
		$.ajax({
        	url: "/monitoring/ajax/get_employee_list",        	
			type: 'get',          
          	dataType: 'json',
          	//async: false,
          	data : { 
            	emp_id : emp_id,
            	page: page,
          	},          
          	beforeSend: function () {
            	//$("#select_employee_modal").modal("show");
          	},
          	success: function (data) {
				var count = data.results.length;

				result += "<div class='row col-12'>";
				result += "<div class='col-8 offset-3 pb-2'>";
				result += "<form id='cus_main_search_district_modal_form' class='form-inline col-12' accept-charset='UTF-8'>";
				result += "  <div class='form-group mx-sm-3 mb-2'>";
				result += "  <select name='cus_main_cus_district_option' class='form-control form-control-sm' required id='id_cus_main_cus_district_option'>";
				result += "    <option value='1'>District ID</option>";
				result += "    <option value='2'>District</option>";
				result += "    <option value='3' selected>City</option>";
				result += "  </select>&nbsp;&nbsp;&nbsp;&nbsp;";
				result += "    <label for='id_cus_main_search_district' class='sr-only'>Search</label>";            
				result += "    <input type='text' class='form-control form-control-sm' id='id_cus_main_cus_district_search_text' name='cus_main_cus_district_search_text' placeholder=''>";
				result += "  </div>";
				result += "<a href='javascript:cus_main_search_district_modal()' type='button' class='btn btn-primary btn-sm mb-2'>Search</a>";            
				result += "</form>";
				result += "</div>";

				result += "<div class='row col-12'>";
				result += "<table class='table table-hover table-sm'>";
				result += " <thead>";
				result += "   <tr>";
				result += "     <th scope='col'>{% trans 'Emp ID' %}</th>";
				result += "     <th scope='col'>{% trans 'Emp Name (TH)' %}</th>";
				result += "     <th scope='col'>{% trans 'Emp Name (EN)' %}</th>";
				result += "     <th scope='col'>&nbsp;</th>";
				result += "   </tr>";
				result += " </thead>";
				result += "<tbody>";
				result += "</div>";
				result += "<div>";

				for(var i=0; i<count; i++) {              
					var emp_id = data.results[i]["emp_id"];
					var emp_fname_th = data.results[i]["emp_fname_th"];
					var emp_lname_th = data.results[i]["emp_lname_th"];
					result += "<tr>";
					result += "<td>" + emp_id + "</td>";        
					result += "<td>" + emp_fname_th + " " + emp_lname_th + "</td>";
					result += "<td>" + emp_fname_th + " " + emp_lname_th + "</td>";

					result += "<td><a href='javascript:select_employee(" + emp_id + ",\"" + emp_fname_th + "\",\"" + emp_lname_th + "\",\"" + emp_fname_en + "\",\"" + emp_lname_en + "\");' type='button' class='btn btn-outline-primary btn-sm'>Select</a></td>";

					result += "</tr>";              
				}
				result += " </tbody>";
				result += "</table>";				
          	},
          	error: function (data) {
          		result += "Error";
          	},
         });

    	$("#select_employee_modal .modal-body").html(result);    	
    	$("#select_employee_modal").modal("show");
	});

 	$("#save_security_guard_button").click( function() {
    	event.preventDefault();    	


    	if ($('#id_service_active').is(":checked")) {
	    	service_active = 1;
    	} else {
    		service_active = 0;
    	}

    	if ($('#id_relief').is(":checked")) {
	    	relief = 1;
    	} else {
    		relief = 0;
    	}

		$.ajax({
	    	url : "/monitoring/ajax/save_customer_schdule_plan/",
	    	type : "POST",
	    	data : {          
	      		csrfmiddlewaretoken: '{{ csrf_token }}',
	      		cus_id: $("#id_cus_id").val(),
	      		cus_brn: $("#id_cus_brn").val(),
	      		cus_vol: $("#id_cus_vol").val(),
	      		selected_sch_no: $("#id_selected_sch_no").val(),
	      		emp_id: $("#id_emp_id").val(),
	      		sch_active: service_active,
	      		relief: relief,
	      		mon_shift: $("#id_mon_shift").val(),
	      		tue_shift: $("#id_tue_shift").val(),
	      		wed_shift: $("#id_wed_shift").val(),
	      		thu_shift: $("#id_thu_shift").val(),
	      		fri_shift: $("#id_fri_shift").val(),
	      		sat_shift: $("#id_sat_shift").val(),
	      		sun_shift: $("#id_sun_shift").val(),
	    	},
	    	success: function(data) {
			  	$(document).Toasts('create', {
			    	class: data.class, 
			    	title: "{% trans 'System message' %}",
			    	subtitle: '',
			    	autohide: true,
			    	delay: 2000,
			    	body: data.message + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
			    	autoDismiss: true,
			    	close: true,
			    	autoremove: true,
			  	});

			  	//alert("debug");

				// Security Guard List
				result = "";
				result += "<font size='2'>";
				result += "<table class='table table-striped table-sm'>";
				result += "  <thead>";
				result += "    <tr>";
				result += "      <th scope='col'>No1.</th>";
				result += "      <th scope='col'>Name</th>";
				result += "      <th scope='col'>Rank</th>";
				result += "      <th scope='col'>Eff From</th>";
				result += "      <th scope='col'>Eff To</th>";
				result += "      <th scope='col' class='text-center'>MON</th>";
				result += "      <th scope='col' class='text-center'>TUE</th>";
				result += "      <th scope='col' class='text-center'>WED</th>";
				result += "      <th scope='col' class='text-center'>THU</th>";
				result += "      <th scope='col' class='text-center'>FRI</th>";
				result += "      <th scope='col' class='text-center'>SAT</th>";
				result += "      <th scope='col' class='text-center'>SUN</th>";
				result += "      <th scope='col' class='text-center'>Active</th>";
				result += "      <th scope='col'>Relief</th>";
				result += "      <th scope='col'>Upd Date</th>";
				result += "      <th scope='col'>Upd By</th>";
				result += "      <th scope='col'>Upd Flag</th>";
				result += "		 <th scope='col'>&nbsp;</th>";
				result += "    </tr>";
				result += "  </thead>";					
				result += "  <tbody>";

				if(data.sch_plan_list.length>0) {
					count = 1;
					for(i=0; i<data.sch_plan_list.length; i++) {
						result += "    <tr>";
						result += "      <th scope='row'>" + count + "</th>";							
						result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] +"'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
						result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
						result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
						result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";


						if(data.sch_plan_list[i]["sch_shf_mon"] == "99")
							result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
						else
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
						
						if(data.sch_plan_list[i]["sch_shf_tue"] == "99")
							result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";
						else
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";

						if(data.sch_plan_list[i]["sch_shf_wed"] == "99")
							result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";
						else
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";

						if(data.sch_plan_list[i]["sch_shf_thu"] == "99")
							result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";
						else
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";

						if(data.sch_plan_list[i]["sch_shf_fri"] == "99")
							result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
						else
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
						
						if(data.sch_plan_list[i]["sch_shf_sat"] == "99")
							result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
						else
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
						
						if(data.sch_plan_list[i]["sch_shf_sun"] == "99")
							result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";
						else
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";


						if(data.sch_plan_list[i]["sch_active"]==1)
							result += "      <td class='text-center'>Y</td>";
						else
							result += "      <td class='text-center'>&nbsp;</td>";

						if(data.sch_plan_list[i]["relief"]==1)
							result += "      <td class='text-center'>Y</td>";
						else
							result += "      <td class='text-center'>&nbsp;</td>";

						result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
						result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
						result += "      <td>" + data.sch_plan_list[i]["upd_flag"] + "</td>";
						
				        result += "		 <td class='text-left align-center'>";
				        result += "		   <div class='btn-group btn-group-xs' mt-2>";
				        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
				        result += "      <i class='fas fa-pen fa-xs'></i>";
				        result += "   		</a>";					       
				        //result += "		     &nbsp;";
				        //result += "		     <button type='button' id='btn_delete_customer' class='btn btn-danger btn-xs js-delete-customer' data-url='' >";
				        //result += "		       <i class='fas fa-trash fa-xs'></i>";
				        //result += "		     </button>";
				        result += "		   </div>";
				        result += "		 </td>";

						result += "    </tr>";						
						count++;
					}
				} else {
					result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
				}

				result += "  </tbody>";
				result += "</table>";
				result += "</font>";
							
				$("#id_security_guard_list").html(result);	
				//$("#security_guard_list_amount").html("<b>Total " + data.sch_plan_list.length + "</b>");
				//$("#security_guard_list_amount").html("<b>Total 0</b>");
	    	},
	    	error: function(data) {
			  	$(document).Toasts('create', {
			    	class: data.class, 
			    	title: "{% trans 'System message' %}",
			    	subtitle: '',
			    	autohide: true,
			    	delay: 2000,
			    	body: data.message + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
			    	autoDismiss: true,
			    	close: true,
			    	autoremove: true,
			  	});	    		
	    	}
	    });

    });

 	$("#cancelCustomerServicePersonButton").click( function() {
    	event.preventDefault();    	

    	$("#schedule_maintenance_form :input").attr("disabled", false);
    	
    	$("#schedule_maintenance_form").trigger("reset");
    	$("#contract_service_list_form").trigger("reset");
		$("#security_guard_list_form").trigger("reset");

    	$('#contract_service_persion_list_form').trigger("reset");		    	
		$("#customer_name_title").html("");
		$("#contract_service_list_form :input").attr("disabled", true);
		$("#security_guard_list_form :input").attr("disabled", true);
		$("#contract_service_list_form").trigger("reset");

		$(".card-contract-service-list .card-body").html("");
		
		//$(".card-security-guard-list .card-body").html("");
		$("#id_security_guard_list").html("");

		$("#contract_service_list_amount").html("Total 0");
		$("#security_guard_list_amount").html("Total 0");

    	$("#id_cus_id").focus();
    	$("#id_cus_id").select();
  	});

 	$("#saveSecurityGuardButton").click( function() {
    	event.preventDefault();
    	alert("todo");
    });
 	 	
	$('input[type=radio][name=security_guard_list_status_option]').change(function() {
		// Security Guard List
		result = "";
		result += "<font size='2'>";
		result += "<table class='table table-striped table-sm'>";
		result += "  <thead>";
		result += "    <tr>";
		result += "      <th scope='col'>No.</th>";
		result += "      <th scope='col'>Name</th>";
		result += "      <th scope='col'>Rank</th>";
		result += "      <th scope='col'>Eff From</th>";
		result += "      <th scope='col'>Eff To</th>";
		result += "      <th scope='col' class='text-center'>MON</th>";
		result += "      <th scope='col' class='text-center'>TUE</th>";
		result += "      <th scope='col' class='text-center'>WED</th>";
		result += "      <th scope='col' class='text-center'>THU</th>";
		result += "      <th scope='col' class='text-center'>FRI</th>";
		result += "      <th scope='col' class='text-center'>SAT</th>";
		result += "      <th scope='col' class='text-center'>SUN</th>";
		result += "      <th scope='col' class='text-center'>Active</th>";
		result += "      <th scope='col'>Relief</th>";
		result += "      <th scope='col'>Upd Date</th>";
		result += "      <th scope='col'>Upd By</th>";
		result += "      <th scope='col'>Upd Flag</th>";
		result += "      <th scope='col'>&nbsp;</th>";
		result += "    </tr>";
		result += "  </thead>";					
		result += "  <tbody>";

	    if (this.value == '1') {
			$.ajax({
	        	url : "/monitoring/ajax/get_customer_schdule_plan_list/",
	        	type : "POST",
	        	async: false,
	        	data : {          
	          		csrfmiddlewaretoken: '{{ csrf_token }}',
	          		cus_id: $("#id_cus_id").val(),
	          		cus_brn: $("#id_cus_brn").val(),
	          		cus_vol: $("#id_cus_vol").val(),
	          		sch_active: this.value
	        	},
	        	success: function(data) {
	        		total = data.sch_plan_list.length;

					if(total>0) {
						count = 1;
						for(i=0; i<total; i++) {								
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] +"'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";

							if(data.sch_plan_list[i]["sch_active"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_flag"] + "</td>";

							//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";			
							count++;
						}
						result += "  </tbody>";
						result += "</table>";
						result += "</font>";
						
						//$(".card-security-guard-list .card-body").html(result);
						$("#id_security_guard_list").html(result);

						$("#security_guard_list_amount").html("<b>Total " + total + "</b>");

					} else {
						result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
						result += "  </tbody>";
						result += "</table>";
						result += "</font>";
						
						//$(".card-security-guard-list .card-body").html(result);
						$("#id_security_guard_list").html(result);
						$("#security_guard_list_amount").html("<b>Total 0</b>");
					}
	        	},
	        	error: function(data) {	        		
	          		result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";			
					result += "  </tbody>";
					result += "</table>";
					result += "</font>";
					if(count > 0)
						count = count - 1;

					//$(".card-security-guard-list .card-body").html(result);
					$("#id_security_guard_list").html(result);
					$("#security_guard_list_amount").html("<b>Total 0</b>");		          		
	        	}   	
	        });	    	
	    }
	    else if (this.value == '2') {
			$("#id_security_guard_list").html("Loading...");
			$("#security_guard_list_amount").html("<b>Total 0</b>");

			$.ajax({

	        	url : "/monitoring/ajax/get_customer_schdule_plan_list/",
	        	type : "POST",
	        	async: false,
	        	data : {          
	          		csrfmiddlewaretoken: '{{ csrf_token }}',
	          		cus_id: $("#id_cus_id").val(),
	          		cus_brn: $("#id_cus_brn").val(),
	          		cus_vol: $("#id_cus_vol").val(),
	          		sch_active: this.value
	        	},
	        	success: function(data) {
	        		total = data.sch_plan_list.length;
					if(total>0) {
						count = 1;
						for(i=0; i<total; i++) {								
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] +"'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";

							if(data.sch_plan_list[i]["sch_active"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_flag"] + "</td>";
														//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";						
							count++;
						}
						result += "  </tbody>";
						result += "</table>";
						result += "</font>";
						
						//$(".card-security-guard-list .card-body").html(result);
						$("#id_security_guard_list").html(result);

						$("#security_guard_list_amount").html("<b>Total " + total + "</b>");							
					} else {
						result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
						result += "  </tbody>";
						result += "</table>";
						result += "</font>";

						//$(".card-security-guard-list .card-body").html(result);
						$("#id_security_guard_list").html(result);

						$("#security_guard_list_amount").html("<b>Total 0</b>");
					}
	        	},
	        	error: function(data) {	        		
	          		result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
					result += "  </tbody>";
					result += "</table>";
					result += "</font>";
					
					//$(".card-security-guard-list .card-body").html(result);
					$("#id_security_guard_list").html(result);
					
					$("#security_guard_list_amount").html("<b>Total 0</b>");
	        	}   	
	        });

	    } else if (this.value == '3') {

			$.ajax({

	        	url : "/monitoring/ajax/get_customer_schdule_plan_list/",
	        	type : "POST",
	        	async: false,
	        	data : {          
	          		csrfmiddlewaretoken: '{{ csrf_token }}',
	          		cus_id: $("#id_cus_id").val(),
	          		cus_brn: $("#id_cus_brn").val(),
	          		cus_vol: $("#id_cus_vol").val(),
	          		sch_active: this.value
	        	},
	        	success: function(data) {	        		
	        		total = data.sch_plan_list.length;
					if(total>0) {
						count = 1;						
						for(i=0; i<total; i++) {
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] +"'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";

							if(data.sch_plan_list[i]["sch_active"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_flag"] + "</td>";
														//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";						
							count++;
						}
						result += "  </tbody>";
						result += "</table>";
						result += "</font>";
						
						//$(".card-security-guard-list .card-body").html(result);
						$("#id_security_guard_list").html(result);

						$("#security_guard_list_amount").html("<b>Total " + total + "</b>");							
					} else {
						result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
						result += "  </tbody>";
						result += "</table>";
						result += "</font>";
						$("#security_guard_list_amount").html("<b>Total 0</b>");
					}
	        	},
	        	error: function(data) {	        		
	          		result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
					result += "  </tbody>";
					result += "</table>";
					result += "</font>";
					
					//$(".card-security-guard-list .card-body").html(result);
					$("#id_security_guard_list").html(result);

					$("#security_guard_list_amount").html("<b>Total 0</b>");		          		
	        	},	        
	        });	  
	    } else {
	    	result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
			result += "  </tbody>";
			result += "</table>";
			result += "</font>";
			
			//$(".card-security-guard-list .card-body").html(result);
			$("#id_security_guard_list").html(result);

			$("#security_guard_list_amount").html("<b>Total 0</b>");		    	
	    }
	});



});

$(document).on('keypress', '#id_cus_id', function(e) {
	if(e.which == 13) {      
		e.preventDefault();

		var obj = $(this);
      	var id_cus_id = obj.val();
      	while (id_cus_id.length < 7) 
        	id_cus_id = "0" + id_cus_id;      	
      	$('#id_cus_id').val(id_cus_id);

		$('#id_cus_brn').focus();
	}
});

$(document).on('keypress', '#id_cus_brn', function(e) {
	if(e.which == 13) {      
		e.preventDefault();

		var obj = $(this);
      	var id_cus_brn = obj.val();
      	while (id_cus_brn.length < 3) 
        	id_cus_brn = "0" + id_cus_brn;
      	$('#id_cus_brn').val(id_cus_brn);
		$('#id_cus_vol').focus();
	}
});

$(document).on('keypress', '#id_cus_vol', function(e) {
	if(e.which == 13) {      
		e.preventDefault();

		// TODO: field validation
		cus_id = $('#id_cus_id').val();
		cus_brn = $('#id_cus_brn').val();
		cus_vol = $('#id_cus_vol').val();
		
		if(cus_id=="") {
			alert("Please entet Customer ID.");
			$('#id_cus_id').focus();				
			return false;
		}

		if(cus_brn=="") {
			alert("Please entet Customer Branch.");
			$('#id_cus_brn').focus();
			return false;			
		}

		if(cus_vol=="") {
			alert("Please entet Customer Volume.");
			$('#id_cus_vol').focus();
			return false;
		}

		var obj = $(this);
      	var id_cus_vol = obj.val();
      	while (id_cus_vol.length < 3) 
        	id_cus_vol = "0" + id_cus_vol;
      	$('#id_cus_vol').val(id_cus_vol);

		// Get customer data (ajax)      	
		$.ajax({
        	url : "/monitoring/ajax/get_customer/",
        	type : "POST",
        	data : {          
          	csrfmiddlewaretoken: '{{ csrf_token }}',
          	cus_id: cus_id,
          	cus_brn: cus_brn,
          	cus_vol: cus_vol,
        	},
        	success : function(data) {				
				
				if(data.is_existed) {
					$("#contract_service_list_form :input").attr("disabled", false);
					$("#security_guard_list_form :input").attr("disabled", false);					
					$("#save_security_guard_button").attr("disabled", true);

					$("#schedule_maintenance_form :input").attr("disabled", true);					
					$("#cancelCustomerServicePersonButton").attr("disabled", false);

					result_title = "";
					result_title = "<h3 class='m-0 text-dark'>" + data.cus_site_name_th + "<small>&nbsp;&nbsp;<button type='button' class='btn btn-tool' data-card-widget='collapse'><i class='fas fa-angle-down text-primary'></i></button></small></h3>";

					$("#id_cnt_doc_no").val(data.cnt_doc_no);

					var cnt_active = data.cnt_active;
					if(cnt_active==1) {
						$('#id_cnt_active').val(1);
						$('#id_cnt_active').prop("checked", true);
					} else {
						$('#id_cnt_active').val(0);
						$('#id_cnt_active').prop("checked", false);
					}

					$("#id_cnt_sign_frm").val(data.cnt_sign_frm);
					$("#id_cnt_sign_to").val(data.cnt_sign_to);					
					$("#id_cnt_eff_frm").val(data.cnt_eff_frm);
					$("#id_cnt_eff_to").val(data.cnt_eff_to);
					$("#id_cnt_wage_name_en").val(data.cnt_wage_name_en);
					$("#id_cnt_apr_by_name_en").val(data.cnt_apr_by_name_en);

					$("#id_cus_main_cus_name_th").val(data.cus_main_cus_name_th + " (" + data.cus_main_cus_name_en + ")");
					$("#id_cus_main_cus_tel").val(data.cus_main_cus_tel);
					$("#id_cus_site_name_th").val(data.cus_site_name_th + " (" + data.cus_site_name_en + " )");
					$("#id_cus_site_add_th").val(data.cus_site_add_th + " " + data.cus_site_district_th + " " + data.cus_site_city_th + " " + data.cus_site_zip + " " + data.cus_site_country_th);
					$("#id_cus_site_tel").val(data.cus_site_tel);
					$("#id_cus_site_contact_name_th").val(data.cus_site_contact_name_th + " (" + data.cus_site_contact_position_th + ")");

					// Contract Service List
					result = "";
					result += "<font size='2'>";
					result += "<table class='table table-striped table-sm'>";
					result += "  <thead>";
					result += "    <tr>";
					result += "      <th scope='col'>No.</th>";
					result += "      <th scope='col'>Rank</th>";
					result += "      <th scope='col'>Shift</th>";
					result += "      <th scope='col' class='text-center'>QTY</th>";
					result += "      <th scope='col'>Eff From</th>";
					result += "      <th scope='col'>Eff To</th>";
					result += "      <th scope='col' class='text-center'>MON</th>";
					result += "      <th scope='col' class='text-center'>TUE</th>";
					result += "      <th scope='col' class='text-center'>WED</th>";
					result += "      <th scope='col' class='text-center'>THU</th>";
					result += "      <th scope='col' class='text-center'>FRI</th>";
					result += "      <th scope='col' class='text-center'>SAT</th>";
					result += "      <th scope='col' class='text-center'>SUN</th>";
					result += "      <th scope='col' class='text-center'>PUB</th>";
					result += "      <th scope='col' class='text-center'>Active</th>";
					result += "      <th scope='col'>Remark</th>";
					result += "    </tr>";
					result += "  </thead>";
					result += "  <tbody>";

					if(data.cus_service_list.length>0) {
						count = 1;
						for(i=0; i<data.cus_service_list.length; i++) {
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";
							result += "      <td>" + data.cus_service_list[i]["srv_rank"] + "</td>";							
							//result += "      <td>" + data.cus_service_list[i]["srv_shif_id"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_shift_name"] + "</td>";							
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_qty"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_eff_frm"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_eff_to"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_mon"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_tue"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_wed"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_thu"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_fri"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_sat"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_sun"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_pub"] + "</td>";
							result += "      <td class='text-center'>" + data.cus_service_list[i]["srv_active"] + "</td>";
							result += "      <td>" + data.cus_service_list[i]["srv_rem"] + "</td>";
							result += "    </tr>";						
							count++;
						}
					} else {
						result += "<tr><td colspan='16' align='center'>There is no data available.</td></tr>";
					}

					result += "  </tbody>";
					result += "</table>";
					result += "</font>";
					$(".card-contract-service-list .card-body").html(result);
					$("#contract_service_list_amount").html("<b>Total " + data.cus_service_list.length + "</b>");

					// Security Guard List
					result = "";
					result += "<font size='2'>";
					result += "<table class='table table-striped table-sm'>";
					result += "  <thead>";
					result += "    <tr>";
					result += "      <th scope='col'>No.</th>";
					result += "      <th scope='col'>Name</th>";
					result += "      <th scope='col'>Rank</th>";
					result += "      <th scope='col'>Eff From</th>";
					result += "      <th scope='col'>Eff To</th>";
					result += "      <th scope='col' class='text-center'>MON</th>";
					result += "      <th scope='col' class='text-center'>TUE</th>";
					result += "      <th scope='col' class='text-center'>WED</th>";
					result += "      <th scope='col' class='text-center'>THU</th>";
					result += "      <th scope='col' class='text-center'>FRI</th>";
					result += "      <th scope='col' class='text-center'>SAT</th>";
					result += "      <th scope='col' class='text-center'>SUN</th>";
					result += "      <th scope='col' class='text-center'>Active</th>";
					result += "      <th scope='col'>Relief</th>";
					result += "      <th scope='col'>Upd Date</th>";
					result += "      <th scope='col'>Upd By</th>";
					result += "      <th scope='col'>Upd Flag</th>";
					result += "		 <th scope='col'>&nbsp;</th>";
					result += "    </tr>";
					result += "  </thead>";					
					result += "  <tbody>";

					if(data.sch_plan_list.length>0) {
						count = 1;
						for(i=0; i<data.sch_plan_list.length; i++) {
							result += "    <tr>";
							result += "      <th scope='row'>" + count + "</th>";							
							result += "      <td><b>" + data.sch_plan_list[i]["emp_id"] + "</b> | <b><a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] +"'); type='button'>" + data.sch_plan_list[i]["emp_fname_th"] + " " + data.sch_plan_list[i]["emp_lname_th"] + "</a></b></td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_rank"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_frm"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["sch_date_to"] + "</td>";


							if(data.sch_plan_list[i]["sch_shf_mon"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_mon"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_tue"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_tue"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_wed"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_wed"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_thu"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_thu"] + "</td>";

							if(data.sch_plan_list[i]["sch_shf_fri"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_fri"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_sat"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sat"] + "</td>";
							
							if(data.sch_plan_list[i]["sch_shf_sun"] == "99")
								result += "      <td class='text-center text-danger'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";
							else
								result += "      <td class='text-center'>" + data.sch_plan_list[i]["sch_shf_sun"] + "</td>";


							if(data.sch_plan_list[i]["sch_active"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							if(data.sch_plan_list[i]["relief"]==1)
								result += "      <td class='text-center'>Y</td>";
							else
								result += "      <td class='text-center'>&nbsp;</td>";

							result += "      <td>" + data.sch_plan_list[i]["upd_date"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_by"] + "</td>";
							result += "      <td>" + data.sch_plan_list[i]["upd_flag"] + "</td>";
							
							//result += "		 <td>&nbsp</td>";
					        result += "		 <td class='text-left align-center'>";
					        result += "		   <div class='btn-group btn-group-xs' mt-2>";
					        result += "		     <a href=javascript:update_sch_plan('" + data.sch_plan_list[i]["sch_no"] + "'); type='button' class='btn btn-outline-primary btn-sm'>";
					        result += "      <i class='fas fa-pen fa-xs'></i>";
					        result += "   		</a>";					       
					        //result += "		     &nbsp;";
					        //result += "		     <button type='button' id='btn_delete_customer' class='btn btn-danger btn-xs js-delete-customer' data-url='' >";
					        //result += "		       <i class='fas fa-trash fa-xs'></i>";
					        //result += "		     </button>";
					        result += "		   </div>";
					        result += "		 </td>";

							result += "    </tr>";						
							count++;
						}
					} else {
						result += "<tr><td colspan='17' align='center'>There is no data available.</td></tr>";
					}

					result += "  </tbody>";
					result += "</table>";
					result += "</font>";
					
					//$(".card-security-guard-list .card-body").html(result);
					$("#id_security_guard_list").html(result);
					
					$("#security_guard_list_amount").html("<b>Total " + data.sch_plan_list.length + "</b>");
				} else {
					result = "";
					$("#contract_service_list_form :input").attr("disabled", true);
					$("#security_guard_list_form :input").attr("disabled", true);
					result = "<h3 class='m-0 text-dark'>Not found<small>&nbsp;&nbsp;<button type='button' class='btn btn-tool' data-card-widget='collapse'><i class='fas fa-angle-down text-primary'></i></button></small></h3>";
				}

				//$("#customer_name_title").html(result_title);
        	},
        	error: function(data){
          		alert("error");
        	}
      	});
      			
	}
});

function update_sch_plan(sch_no) {
	cus_id = $('#id_cus_id').val();
	cus_brn = $('#id_cus_brn').val();
	cus_vol = $('#id_cus_vol').val();
		
	if(cus_id=="") {
		alert("Please entet Customer ID.");
		$('#id_cus_id').focus();				
		return false;
	}

	if(cus_brn=="") {
		alert("Please entet Customer Branch.");
		$('#id_cus_brn').focus();
		return false;			
	}

	if(cus_vol=="") {
		alert("Please entet Customer Volume.");
		$('#id_cus_vol').focus();
		return false;
	}

	if(sch_no=="") {
		return false;			
	}
	
	$.ajax({
    	url : "/monitoring/ajax/get_customer_schdule_plan/",
    	type : "POST",
    	data : {          
      	csrfmiddlewaretoken: '{{ csrf_token }}',
      	cus_id: cus_id,
      	cus_brn: cus_brn,
      	cus_vol: cus_vol,
      	sch_no: sch_no,
    	},
    	success: function(data) {     		
    		$("#id_selected_sch_no").val(data.sch_no);
    		$("#id_emp_id").focus();
    		$("#id_emp_id").val(data.emp_id);
    		$("#id_emp_name_th").val(data.emp_fname_th.trim() + " " + data.emp_lname_th.trim());
    		$("#id_sch_rank").val(data.sch_rank);
    		$("#id_sch_dept").val(data.emp_type);
    		$("#id_duration_from").val(data.sch_date_frm);
    		$("#id_duration_to").val(data.sch_date_to);

    		if(data.sch_active==1) {
    			$("#id_service_active").prop("checked", true);
    		}
    		else {
    			$("#id_service_active").prop("checked", false);
    		}

    		if(data.relief==1) {
    			$("#id_relief").prop("checked", true);
    		}
    		else {
    			$("#id_relief").prop("checked", false);
    		}

    		$("#id_emp_join_date").val(data.emp_join_date);
    		$("#id_emp_term_date").val(data.emp_term_date);
    		$("#id_emp_status").val(data.emp_status_id + " | " + data.emp_status);

    		$("#id_mon_shift").val(data.sch_shf_mon);
    		$("#id_tue_shift").val(data.sch_shf_tue);
    		$("#id_wed_shift").val(data.sch_shf_wed);
    		$("#id_thu_shift").val(data.sch_shf_thu);
    		$("#id_fri_shift").val(data.sch_shf_fri);
    		$("#id_sat_shift").val(data.sch_shf_sat);
    		$("#id_sun_shift").val(data.sch_shf_sun);

    		$("#save_security_guard_button").attr("disabled", false);
    	},
    	error: function(data) {
    		alert("0");
    	},
    });
}
</script>
{% endblock %}

